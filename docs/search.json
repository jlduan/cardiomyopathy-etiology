[
  {
    "objectID": "cardiomyopathy.html#preparation",
    "href": "cardiomyopathy.html#preparation",
    "title": "Accurate Classification of Cardiomyopathy Diagnosis by Chromatin Accessibility",
    "section": "Preparation",
    "text": "Preparation\n\nPROJECT_DIR <- file.path(\n    \"/Users/jialei/Dropbox/Data/Projects/UTSW\",\n    \"/Cardiomyopathy/atac-seq\"\n)\n\nFunctions\n\n\n\nLoad required packages.\n\nlibrary(tidyverse)\n## ── Attaching packages ────────────────────────────────── tidyverse 1.3.2.9000 ──\n## ✔ ggplot2   3.3.6.9000        ✔ dplyr     1.0.99.9000  \n## ✔ tibble    3.1.8.9001        ✔ stringr   1.4.1.9000   \n## ✔ tidyr     1.2.1.9000        ✔ forcats   0.5.2.9000   \n## ✔ readr     2.1.2.9000        ✔ lubridate 1.8.0.9000   \n## ✔ purrr     0.9000.0.9000     \n## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n## ✖ dplyr::filter() masks stats::filter()\n## ✖ dplyr::lag()    masks stats::lag()\nlibrary(Matrix)\n## \n## Attaching package: 'Matrix'\n## \n## The following objects are masked from 'package:tidyr':\n## \n##     expand, pack, unpack\nlibrary(patchwork)\nlibrary(extrafont)\n## Registering fonts with R\n\n\nsource(\n    file = file.path(\n        SCRIPT_DIR,\n        \"utilities.R\"\n    )\n)\n\n\n`%+replace%` <- ggplot2::`%+replace%`\n\n\n\n\n\n\n\nPython env\n\nnp <- reticulate::import(\"numpy\", convert = TRUE)\ncat(\"numpy version:\", np$`__version__`, \"\\n\")\n\nnumpy version: 1.22.4 \n\n\n\nreticulate::py_config()\n\npython:         /Users/jialei/.pyenv/shims/python\nlibpython:      /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/libpython3.9.dylib\npythonhome:     /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10:/Users/jialei/.pyenv/versions/mambaforge-4.10.3-10\nversion:        3.9.13 | packaged by conda-forge | (main, May 27 2022, 17:00:33)  [Clang 13.0.1 ]\nnumpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy\nnumpy_version:  1.22.4\nnumpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy\n\nNOTE: Python version was forced by RETICULATE_PYTHON"
  },
  {
    "objectID": "cardiomyopathy.html#differentially-accessible-regions",
    "href": "cardiomyopathy.html#differentially-accessible-regions",
    "title": "Accurate Classification of Cardiomyopathy Diagnosis by Chromatin Accessibility",
    "section": "Differentially accessible regions",
    "text": "Differentially accessible regions\n\n# define function\ncompute_diff_peaks <- function(matrix,\n                               group_a,\n                               group_b,\n                               num_thread = 4) {\n    cat(length(group_a), \"\\n\")\n    cat(length(group_b), \"\\n\")\n\n    cts <- matrix[, c(\n        group_a,\n        group_b\n    )]\n    cat(ncol(cts), \"\\n\")\n\n    col_data <- data.frame(\n        sample = c(group_a, group_b),\n        category = c(\n            rep(\"group_a\", length(group_a)),\n            rep(\"group_b\", length(group_b))\n        )\n    )\n\n    BiocParallel::register(BiocParallel::MulticoreParam(num_thread))\n\n    dds <- DESeq2::DESeqDataSetFromMatrix(\n        countData = cts,\n        colData = col_data,\n        design = ~category\n    )\n\n    dds <- DESeq2::DESeq(dds)\n    res <- DESeq2::results(dds)\n    DESeq2::summary(res)\n\n    return(res)\n}\n\n\n# sample metadata\nsamples_fresh_healthy <- c(\n    \"F1_1\", \"F1_2\", \"F2_1\", \"F2_2\",\n    \"F5_1\", \"F5_2\", \"P3_1\", \"P3_2\",\n    \"P5_1\", \"P5_2\", \"P6_1\", \"P6_2\"\n)\n\nsamples_fresh_icm <- c(\n    \"P104a_1\", \"P104a_2\", \"P117b_1\", \"P117b_2\",\n    \"P123b_1\", \"P123b_2\", \"P131a_1\", \"P131a_2\",\n    \"P92a_1\", \"P92a_2\"\n)\n\nsamples_fresh_nicm <- c(\n    \"P114b_1\", \"P114b_2\", \"P59a_1\", \"P59a_2\",\n    \"P60a_1\", \"P60a_2\", \"P73a_1\", \"P73a_2\",\n    \"P87a_1\", \"P87a_2\"\n)\n\nsamples_fresh_hcm <- c(\n    \"HOCM4_1\", \"HOCM4_2\", \"HOCM6_1\", \"HOCM6_2\",\n    \"HOCM9_1\", \"HOCM9_2\", \"HOCM11_1\", \"HOCM11_2\",\n    \"HOCM7_1\", \"HOCM7_2\"\n)\n\n\nsamples <- list(\n    fresh_healthy = samples_fresh_healthy,\n    fresh_icm = samples_fresh_icm,\n    fresh_nicm = samples_fresh_nicm,\n    fresh_hcm = samples_fresh_hcm\n)\n\nPairwise comparison\n\nsamples_combn <- combinat::combn(x = names(samples), m = 2)\n\ndiff_peaks <- purrr::map(seq_len(ncol(samples_combn)), \\(x) {\n    sample_names_a <- samples[[samples_combn[, x][1]]]\n    sample_names_b <- samples[[samples_combn[, x][2]]]\n\n    cat(length(sample_names_a), \"\\n\")\n    cat(sample_names_a, \"\\n\")\n    cat(length(sample_names_b), \"\\n\")\n    cat(sample_names_b, \"\\n\")\n\n    compute_diff_peaks(\n        matrix = matrix_readcount_use,\n        group_a = sample_names_a,\n        group_b = sample_names_b,\n        num_thread = parallel::detectCores() - 1\n    )\n})\n\n12 \nF1_1 F1_2 F2_1 F2_2 F5_1 F5_2 P3_1 P3_2 P5_1 P5_2 P6_1 P6_2 \n10 \nP104a_1 P104a_2 P117b_1 P117b_2 P123b_1 P123b_2 P131a_1 P131a_2 P92a_1 P92a_2 \n12 \n10 \n22 \n\n\nWarning in DESeqDataSet(se, design = design, ignoreRank): some variables in\ndesign formula are characters, converting to factors\n\n\nestimating size factors\n\n\nestimating dispersions\n\n\ngene-wise dispersion estimates\n\n\nmean-dispersion relationship\n\n\nfinal dispersion estimates\n\n\nfitting model and testing\n\n\n\nout of 206017 with nonzero total read count\nadjusted p-value < 0.1\nLFC > 0 (up)       : 20685, 10%\nLFC < 0 (down)     : 16920, 8.2%\noutliers [1]       : 0, 0%\nlow counts [2]     : 0, 0%\n(mean count < 0)\n[1] see 'cooksCutoff' argument of ?results\n[2] see 'independentFiltering' argument of ?results\n\n12 \nF1_1 F1_2 F2_1 F2_2 F5_1 F5_2 P3_1 P3_2 P5_1 P5_2 P6_1 P6_2 \n10 \nP114b_1 P114b_2 P59a_1 P59a_2 P60a_1 P60a_2 P73a_1 P73a_2 P87a_1 P87a_2 \n12 \n10 \n22 \n\n\nWarning in DESeqDataSet(se, design = design, ignoreRank): some variables in\ndesign formula are characters, converting to factors\n\n\nestimating size factors\n\n\nestimating dispersions\n\n\ngene-wise dispersion estimates\n\n\nmean-dispersion relationship\n\n\nfinal dispersion estimates\n\n\nfitting model and testing\n\n\n-- replacing outliers and refitting for 3 genes\n-- DESeq argument 'minReplicatesForReplace' = 7 \n-- original counts are preserved in counts(dds)\n\n\nestimating dispersions\n\n\nfitting model and testing\n\n\n\nout of 206019 with nonzero total read count\nadjusted p-value < 0.1\nLFC > 0 (up)       : 7721, 3.7%\nLFC < 0 (down)     : 4264, 2.1%\noutliers [1]       : 0, 0%\nlow counts [2]     : 31954, 16%\n(mean count < 5)\n[1] see 'cooksCutoff' argument of ?results\n[2] see 'independentFiltering' argument of ?results\n\n12 \nF1_1 F1_2 F2_1 F2_2 F5_1 F5_2 P3_1 P3_2 P5_1 P5_2 P6_1 P6_2 \n10 \nHOCM4_1 HOCM4_2 HOCM6_1 HOCM6_2 HOCM9_1 HOCM9_2 HOCM11_1 HOCM11_2 HOCM7_1 HOCM7_2 \n12 \n10 \n22 \n\n\nWarning in DESeqDataSet(se, design = design, ignoreRank): some variables in\ndesign formula are characters, converting to factors\n\n\nestimating size factors\n\n\nestimating dispersions\n\n\ngene-wise dispersion estimates\n\n\nmean-dispersion relationship\n\n\nfinal dispersion estimates\n\n\nfitting model and testing\n\n\n-- replacing outliers and refitting for 4 genes\n-- DESeq argument 'minReplicatesForReplace' = 7 \n-- original counts are preserved in counts(dds)\n\n\nestimating dispersions\n\n\nfitting model and testing\n\n\n\nout of 206019 with nonzero total read count\nadjusted p-value < 0.1\nLFC > 0 (up)       : 3112, 1.5%\nLFC < 0 (down)     : 3829, 1.9%\noutliers [1]       : 0, 0%\nlow counts [2]     : 23966, 12%\n(mean count < 4)\n[1] see 'cooksCutoff' argument of ?results\n[2] see 'independentFiltering' argument of ?results\n\n10 \nP104a_1 P104a_2 P117b_1 P117b_2 P123b_1 P123b_2 P131a_1 P131a_2 P92a_1 P92a_2 \n10 \nP114b_1 P114b_2 P59a_1 P59a_2 P60a_1 P60a_2 P73a_1 P73a_2 P87a_1 P87a_2 \n10 \n10 \n20 \n\n\nWarning in DESeqDataSet(se, design = design, ignoreRank): some variables in\ndesign formula are characters, converting to factors\n\n\nestimating size factors\n\n\nestimating dispersions\n\n\ngene-wise dispersion estimates\n\n\nmean-dispersion relationship\n\n\nfinal dispersion estimates\n\n\nfitting model and testing\n\n\n-- replacing outliers and refitting for 3 genes\n-- DESeq argument 'minReplicatesForReplace' = 7 \n-- original counts are preserved in counts(dds)\n\n\nestimating dispersions\n\n\nfitting model and testing\n\n\n\nout of 206018 with nonzero total read count\nadjusted p-value < 0.1\nLFC > 0 (up)       : 7031, 3.4%\nLFC < 0 (down)     : 12331, 6%\noutliers [1]       : 0, 0%\nlow counts [2]     : 59914, 29%\n(mean count < 5)\n[1] see 'cooksCutoff' argument of ?results\n[2] see 'independentFiltering' argument of ?results\n\n10 \nP104a_1 P104a_2 P117b_1 P117b_2 P123b_1 P123b_2 P131a_1 P131a_2 P92a_1 P92a_2 \n10 \nHOCM4_1 HOCM4_2 HOCM6_1 HOCM6_2 HOCM9_1 HOCM9_2 HOCM11_1 HOCM11_2 HOCM7_1 HOCM7_2 \n10 \n10 \n20 \n\n\nWarning in DESeqDataSet(se, design = design, ignoreRank): some variables in\ndesign formula are characters, converting to factors\n\n\nestimating size factors\n\n\nestimating dispersions\n\n\ngene-wise dispersion estimates\n\n\nmean-dispersion relationship\n\n\nfinal dispersion estimates\n\n\nfitting model and testing\n\n\n-- replacing outliers and refitting for 5 genes\n-- DESeq argument 'minReplicatesForReplace' = 7 \n-- original counts are preserved in counts(dds)\n\n\nestimating dispersions\n\n\nfitting model and testing\n\n\n\nout of 206019 with nonzero total read count\nadjusted p-value < 0.1\nLFC > 0 (up)       : 9286, 4.5%\nLFC < 0 (down)     : 15191, 7.4%\noutliers [1]       : 0, 0%\nlow counts [2]     : 39943, 19%\n(mean count < 5)\n[1] see 'cooksCutoff' argument of ?results\n[2] see 'independentFiltering' argument of ?results\n\n10 \nP114b_1 P114b_2 P59a_1 P59a_2 P60a_1 P60a_2 P73a_1 P73a_2 P87a_1 P87a_2 \n10 \nHOCM4_1 HOCM4_2 HOCM6_1 HOCM6_2 HOCM9_1 HOCM9_2 HOCM11_1 HOCM11_2 HOCM7_1 HOCM7_2 \n10 \n10 \n20 \n\n\nWarning in DESeqDataSet(se, design = design, ignoreRank): some variables in\ndesign formula are characters, converting to factors\n\n\nestimating size factors\n\n\nestimating dispersions\n\n\ngene-wise dispersion estimates\n\n\nmean-dispersion relationship\n\n\nfinal dispersion estimates\n\n\nfitting model and testing\n\n\n-- replacing outliers and refitting for 5 genes\n-- DESeq argument 'minReplicatesForReplace' = 7 \n-- original counts are preserved in counts(dds)\n\n\nestimating dispersions\n\n\nfitting model and testing\n\n\n\nout of 206018 with nonzero total read count\nadjusted p-value < 0.1\nLFC > 0 (up)       : 3799, 1.8%\nLFC < 0 (down)     : 7798, 3.8%\noutliers [1]       : 0, 0%\nlow counts [2]     : 79885, 39%\n(mean count < 7)\n[1] see 'cooksCutoff' argument of ?results\n[2] see 'independentFiltering' argument of ?results\n\nnames(diff_peaks) <- purrr::map_chr(\n    seq_len(ncol(samples_combn)), \\(x) {\n        paste(samples_combn[, x], collapse = \"_vs_\")\n    }\n)\n\n\n\n\n\n\n\n\nFC_THRESHOLD <- 1\nPADJ_THRESHOLD <- 0.01\n\nfeatures_selected <- purrr::map(diff_peaks, \\(x) {\n    x |>\n        as.data.frame() |>\n        dplyr::filter(\n            padj < PADJ_THRESHOLD,\n            abs(log2FoldChange) >= FC_THRESHOLD\n        ) |>\n        tibble::rownames_to_column(var = \"feature\") |>\n        pull(feature)\n}) |>\n    unlist() |>\n    unique()\n\nLoading required package: DESeq2\n\n\nLoading required package: S4Vectors\n\n\nLoading required package: stats4\n\n\nLoading required package: BiocGenerics\n\n\n\nAttaching package: 'BiocGenerics'\n\n\nThe following objects are masked from 'package:lubridate':\n\n    intersect, setdiff, union\n\n\nThe following objects are masked from 'package:dplyr':\n\n    combine, intersect, setdiff, union\n\n\nThe following objects are masked from 'package:stats':\n\n    IQR, mad, sd, var, xtabs\n\n\nThe following objects are masked from 'package:base':\n\n    anyDuplicated, append, as.data.frame, basename, cbind, colnames,\n    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,\n    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,\n    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,\n    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,\n    union, unique, unsplit, which.max, which.min\n\n\n\nAttaching package: 'S4Vectors'\n\n\nThe following objects are masked from 'package:Matrix':\n\n    expand, unname\n\n\nThe following objects are masked from 'package:lubridate':\n\n    second, second<-\n\n\nThe following objects are masked from 'package:dplyr':\n\n    first, rename\n\n\nThe following object is masked from 'package:tidyr':\n\n    expand\n\n\nThe following objects are masked from 'package:base':\n\n    expand.grid, I, unname\n\n\nLoading required package: IRanges\n\n\n\nAttaching package: 'IRanges'\n\n\nThe following object is masked from 'package:lubridate':\n\n    %within%\n\n\nThe following objects are masked from 'package:dplyr':\n\n    collapse, desc, slice\n\n\nThe following object is masked from 'package:purrr':\n\n    reduce\n\n\nLoading required package: GenomicRanges\n\n\nLoading required package: GenomeInfoDb\n\n\nLoading required package: SummarizedExperiment\n\n\nLoading required package: MatrixGenerics\n\n\nLoading required package: matrixStats\n\n\n\nAttaching package: 'matrixStats'\n\n\nThe following object is masked from 'package:dplyr':\n\n    count\n\n\n\nAttaching package: 'MatrixGenerics'\n\n\nThe following objects are masked from 'package:matrixStats':\n\n    colAlls, colAnyNAs, colAnys, colAvgsPerRowSet, colCollapse,\n    colCounts, colCummaxs, colCummins, colCumprods, colCumsums,\n    colDiffs, colIQRDiffs, colIQRs, colLogSumExps, colMadDiffs,\n    colMads, colMaxs, colMeans2, colMedians, colMins, colOrderStats,\n    colProds, colQuantiles, colRanges, colRanks, colSdDiffs, colSds,\n    colSums2, colTabulates, colVarDiffs, colVars, colWeightedMads,\n    colWeightedMeans, colWeightedMedians, colWeightedSds,\n    colWeightedVars, rowAlls, rowAnyNAs, rowAnys, rowAvgsPerColSet,\n    rowCollapse, rowCounts, rowCummaxs, rowCummins, rowCumprods,\n    rowCumsums, rowDiffs, rowIQRDiffs, rowIQRs, rowLogSumExps,\n    rowMadDiffs, rowMads, rowMaxs, rowMeans2, rowMedians, rowMins,\n    rowOrderStats, rowProds, rowQuantiles, rowRanges, rowRanks,\n    rowSdDiffs, rowSds, rowSums2, rowTabulates, rowVarDiffs, rowVars,\n    rowWeightedMads, rowWeightedMeans, rowWeightedMedians,\n    rowWeightedSds, rowWeightedVars\n\n\nLoading required package: Biobase\n\n\nWelcome to Bioconductor\n\n    Vignettes contain introductory material; view with\n    'browseVignettes()'. To cite Bioconductor, see\n    'citation(\"Biobase\")', and for packages 'citation(\"pkgname\")'.\n\n\n\nAttaching package: 'Biobase'\n\n\nThe following object is masked from 'package:MatrixGenerics':\n\n    rowMedians\n\n\nThe following objects are masked from 'package:matrixStats':\n\n    anyMissing, rowMedians\n\nfeatures_selected |> length()\n\n[1] 5753\n\n\n\n# sanity check\nstopifnot(\n    length(features_selected) == 5753\n)\n\n\n\n\nHealthy vs. disease\n\ndiff_peaks <- compute_diff_peaks(\n    matrix = matrix_readcount_use,\n    group_a = samples_fresh_healthy,\n    group_b = c(\n        samples_fresh_icm,\n        samples_fresh_nicm,\n        samples_fresh_hcm\n    ),\n    num_thread = parallel::detectCores() - 1\n)\n\n12 \n30 \n42 \n\nout of 206019 with nonzero total read count\nadjusted p-value < 0.1\nLFC > 0 (up)       : 14884, 7.2%\nLFC < 0 (down)     : 15309, 7.4%\noutliers [1]       : 0, 0%\nlow counts [2]     : 0, 0%\n(mean count < 0)\n[1] see 'cooksCutoff' argument of ?results\n[2] see 'independentFiltering' argument of ?results\n\n\n\n\n\n\nFC_THRESHOLD <- 1\nPADJ_THRESHOLD <- 0.05\n\n\n\nPlot\nData\n\n\n\n\ndiff_peaks |>\n    as.data.frame() |>\n    tibble::rownames_to_column(var = \"feature\") |>\n    dplyr::mutate(\n        da = dplyr::case_when(\n            (\n                (\n                    abs(log2FoldChange) >= FC_THRESHOLD\n                ) & (\n                    padj <= PADJ_THRESHOLD\n                )\n            ) ~ 1,\n            TRUE ~ 0\n        ),\n        da = as.factor(da)\n    ) |>\n    dplyr::arrange(da) |>\n    dplyr::mutate(\n        category = \"Healthy vs Disease\"\n    ) |>\n    {\n        \\(x)\n        x |>\n            ggplot2::ggplot(\n                ggplot2::aes(\n                    x = log2(baseMean),\n                    y = log2FoldChange,\n                    color = da\n                )\n            ) +\n            ggrastr::rasterise(\n                ggplot2::geom_point(\n                    size = 0.4,\n                    alpha = 1,\n                    stroke = 0, shape = 16\n                ),\n                dpi = 900,\n                dev = \"ragg_png\"\n            ) +\n            ggplot2::geom_density_2d(\n                color = \"steelblue\", size = 0.2\n            ) +\n            ggplot2::scale_color_manual(\n                values = c(\"grey65\", \"salmon\"), guide = \"none\"\n            ) +\n            ggplot2::facet_wrap(\n                ggplot2::vars(category),\n                nrow = 1,\n                strip.position = \"top\",\n            ) +\n            ggplot2::labs(\n                x = expression(paste(\"Log\"[2], \" mean\")),\n                y = expression(paste(\"Log\"[2], \" (fold change)\"))\n            ) +\n            ggplot2::geom_text(\n                data = x |>\n                    dplyr::count(da),\n                ggplot2::aes(label = paste(\"Num:\", n)),\n                x = -5,\n                y = 5,\n                color = \"salmon\",\n                fontface = \"bold\",\n                size = 6 / ggplot2::.pt,\n                hjust = 0,\n                vjust = 1\n            ) +\n            ggplot2::theme_light() %+replace%\n            ggplot2::theme(\n                axis.title = ggplot2::element_text(\n                    family = \"Arial\", size = 7\n                ),\n                axis.text = ggplot2::element_text(\n                    family = \"Arial\", size = 7\n                ),\n                panel.background = ggplot2::element_blank(),\n                strip.text = ggplot2::element_text(\n                    family = \"Arial\",\n                    size = 7,\n                    margin = ggplot2::margin(\n                        t = 4.4, r = 4.4, b = 4.4, l = 4.4, unit = \"pt\"\n                    )\n                )\n            )\n    }()\n\n\n\n\n\n\n\n\n\n\ndiff_peaks |>\n    as.data.frame() |>\n    tibble::rownames_to_column(var = \"feature\") |>\n    dplyr::mutate(\n        da = dplyr::case_when(\n            abs(log2FoldChange) >= FC_THRESHOLD & padj <= PADJ_THRESHOLD ~ 1,\n            TRUE ~ 0\n        ),\n        da = as.factor(da)\n    ) |>\n    dplyr::arrange(da) |>\n    dplyr::mutate(\n        category = \"Healthy vs Disease\"\n    ) |>\n    head(n = 12)\n\n           feature    baseMean log2FoldChange     lfcSE        stat     pvalue\n1  1_181358_181567    6.285720    -0.25082657 0.2225674 -1.12696904 0.25975557\n2  1_183716_183885    2.917794    -0.61104587 0.3185859 -1.91799391 0.05511178\n3  1_183999_184321    5.587581    -0.40899805 0.2454201 -1.66652230 0.09560943\n4  1_191239_191880   16.735046    -0.19449895 0.1594596 -1.21973776 0.22256430\n5  1_267894_268128    6.533567     0.05967949 0.2321327  0.25709207 0.79710770\n6  1_629834_630082  704.298690     0.03921131 0.1246965  0.31445402 0.75317623\n7  1_633881_634177 1670.223559    -0.10947573 0.1252210 -0.87426032 0.38197650\n8  1_778297_779354   78.566315     0.01854268 0.1195157  0.15514849 0.87670426\n9  1_794936_795259    7.667010    -0.44843135 0.2054008 -2.18320186 0.02902095\n10 1_816789_817532   15.907760    -0.26947734 0.1423673 -1.89283152 0.05838028\n11 1_818925_819284    7.305783     0.20719291 0.2135904  0.97004803 0.33202255\n12 1_819939_820383    8.225880     0.01173971 0.2131140  0.05508655 0.95606951\n        padj da           category\n1  0.5057420  0 Healthy vs Disease\n2  0.2128599  0 Healthy vs Disease\n3  0.2896372  0 Healthy vs Disease\n4  0.4649598  0 Healthy vs Disease\n5  0.9045374  0 Healthy vs Disease\n6  0.8802030  0 Healthy vs Disease\n7  0.6229343  0 Healthy vs Disease\n8  0.9438932  0 Healthy vs Disease\n9  0.1480275  0 Healthy vs Disease\n10 0.2197918  0 Healthy vs Disease\n11 0.5774971  0 Healthy vs Disease\n12 0.9813831  0 Healthy vs Disease\n\n\n\n\n\nHeatmap\n\nRASTERISED <- FALSE\n\n\nmatrix_cpm_use <- t(\n    t(matrix_readcount_use) / colSums(matrix_readcount_use)\n) * 1e+06\n\nmatrix_heatmap <- matrix_cpm_use[features_selected, unlist(samples)]\nmatrix_heatmap <- matrix_heatmap[rowSums(matrix_heatmap) != 0, ]\n\nmatrix_heatmap <- log10(matrix_heatmap + 1)\nmatrix_heatmap <- t(scale(t(matrix_heatmap)))\n\nheatmap_limits <- quantile(matrix_heatmap, c(0.05, 0.95))\nmatrix_heatmap[matrix_heatmap < heatmap_limits[1]] <- heatmap_limits[1]\nmatrix_heatmap[matrix_heatmap > heatmap_limits[2]] <- heatmap_limits[2]\n\n\n# hierarchical clustering\nhclust_out_features <- hclust(\n    dist(matrix_heatmap, method = \"euclidean\"),\n    method = \"complete\"\n)\n\nNUM_CENTERS <- 4\nhclust_out_features_df <- cutree(\n    tree = hclust_out_features, k = NUM_CENTERS\n) |>\n    tibble::as_tibble(rownames = \"feature\") |>\n    dplyr::mutate(order = hclust_out_features$order) |>\n    dplyr::rename(hclust_group = value)\n\nhclust_out_features_df <- purrr::map2(\n    c(2, 1, 4, 3), seq_len(NUM_CENTERS), \\(x, y) {\n        hclust_out_features_df |>\n            dplyr::filter(hclust_group == x) |>\n            dplyr::arrange(order) |>\n            dplyr::mutate(group = y)\n    }\n) |>\n    dplyr::bind_rows()\n\n\n\n\n\n# heatmap column annotation\nha_group <- colnames(matrix_heatmap) |>\n    tibble::enframe(value = \"sample\") |>\n    dplyr::left_join(\n        purrr::map(names(samples), \\(x) {\n            data.frame(\n                sample = samples[[x]],\n                group = x\n            )\n        }) |>\n            dplyr::bind_rows(),\n        by = \"sample\"\n    ) |>\n    dplyr::pull(group) |>\n    stringr::str_to_title()\n\nha_column <- ComplexHeatmap::HeatmapAnnotation(\n    group = ComplexHeatmap::anno_simple(\n        ha_group,\n        col = setNames(\n            object = as.character(yarrr::piratepal(palette = \"google\")),\n            nm = names(samples) |>\n                stringr::str_to_title()\n        ),\n        which = \"column\",\n        pt_size = grid::unit(2, \"mm\"),\n        pt_gp = grid::gpar(\n            fontfamily = \"Arial\",\n            fontsize = 5\n        ),\n        simple_anno_size = grid::unit(1.5, \"mm\")\n    ),\n    #\n    show_annotation_name = FALSE,\n    annotation_label = c(\n        \"Group\"\n    ),\n    annotation_name_gp = grid::gpar(fontfamily = \"Arial\", fontsize = 6),\n    annotation_name_side = \"left\"\n)\n\n\n# heatmap row annotation\nha_region <- hclust_out_features_df |>\n    pull(group) |>\n    {\n        \\(x) paste(\"Signature\", x)\n    }()\n\nha_left <- ComplexHeatmap::HeatmapAnnotation(\n    region = ComplexHeatmap::anno_simple(\n        ha_region,\n        col = setNames(\n            object = as.character(yarrr::piratepal(palette = \"google\")),\n            nm = sort(unique(ha_region))\n        ),\n        which = \"row\",\n        pt_gp = grid::gpar(\n            fontfamily = \"Arial\",\n            fontsize = 5\n        ),\n        simple_anno_size = grid::unit(1.5, \"mm\")\n    ),\n    which = \"row\",\n    show_annotation_name = FALSE,\n    annotation_label = c(\n        \"Region\"\n    ),\n    annotation_name_gp = grid::gpar(fontfamily = \"Arial\", fontsize = 6)\n)\n\n\nsample_ids <- tibble::tribble(\n    ~sample_id, ~sample_id_publication,\n    \"F1_1\", \"C1_1\",\n    \"F1_2\", \"C1_2\",\n    \"F2_1\", \"C2_1\",\n    \"F2_2\", \"C2_2\",\n    \"F5_1\", \"C3_1\",\n    \"F5_2\", \"C3_2\",\n    \"P3_1\", \"C4_1\",\n    \"P3_2\", \"C4_2\",\n    \"P5_1\", \"C5_1\",\n    \"P5_2\", \"C5_2\",\n    \"P6_1\", \"C6_1\",\n    \"P6_2\", \"C6_2\",\n    \"P104a_1\", \"I1_1\",\n    \"P104a_2\", \"I1_2\",\n    \"P117b_1\", \"I2_1\",\n    \"P117b_2\", \"I2_2\",\n    \"P123b_1\", \"I3_1\",\n    \"P123b_2\", \"I3_2\",\n    \"P131a_1\", \"I4_1\",\n    \"P131a_2\", \"I4_2\",\n    \"P92a_1\", \"I5_1\",\n    \"P92a_2\", \"I5_2\",\n    \"P114b_1\", \"NI1_1\",\n    \"P114b_2\", \"NI1_2\",\n    \"P59a_1\", \"NI2_1\",\n    \"P59a_2\", \"NI2_2\",\n    \"P60a_1\", \"NI3_1\",\n    \"P60a_2\", \"NI3_2\",\n    \"P73a_1\", \"NI4_1\",\n    \"P73a_2\", \"NI4_2\",\n    \"P87a_1\", \"NI5_1\",\n    \"P87a_2\", \"NI5_2\",\n    \"P75a_1\", \"U1_1\",\n    \"P75a_2\", \"U1_2\",\n    \"P115b_1\", \"U2_1\",\n    \"P115b_2\", \"U2_2\",\n    \"P141a_1\", \"U3_1\",\n    \"P141a_2\", \"U3_2\",\n    \"HOCM4_1\", \"H1_1\",\n    \"HOCM4_2\", \"H1_2\",\n    \"HOCM6_1\", \"H2_1\",\n    \"HOCM6_2\", \"H2_2\",\n    \"HOCM9_1\", \"H3_1\",\n    \"HOCM9_2\", \"H3_2\",\n    \"HOCM11_1\", \"H4_1\",\n    \"HOCM11_2\", \"H4_2\",\n    \"HOCM7_1\", \"H5_1\",\n    \"HOCM7_2\", \"H5_2\",\n    \"MYEC4_2\", \"U6_2\",\n    \"P108b_1\", \"U4_1\",\n    \"P108b_2\", \"U4_2\"\n)\n\nsample_ids <- setNames(\n    object = sample_ids$sample_id_publication,\n    nm = sample_ids$sample_id\n)\n\n\n# heatmap\nht <- ComplexHeatmap::Heatmap(\n    matrix = matrix_heatmap |> as.matrix(),\n    rect_gp = grid::gpar(col = NA, lwd = 0),\n    col = wesanderson::wes_palette(\"Zissou1\", 50, type = \"continuous\"),\n    row_title_gp = grid::gpar(fontfamily = \"Arial\", fontsize = 6),\n    column_title_gp = grid::gpar(fontfamily = \"Arial\", fontsize = 6),\n    column_title_rot = 0,\n    #\n    cluster_rows = FALSE,\n    show_row_dend = FALSE,\n    cluster_columns = FALSE,\n    show_column_dend = FALSE,\n    #\n    show_row_names = FALSE,\n    show_column_names = TRUE,\n    column_labels = sample_ids[colnames(matrix_heatmap)],\n    column_names_gp = grid::gpar(fontfamily = \"Arial\", fontsize = 6),\n    #\n    top_annotation = ha_column,\n    bottom_annotation = NULL,\n    left_annotation = ha_left,\n    #\n    column_split = ha_group |>\n        tibble::enframe() |>\n        dplyr::mutate(\n            value = stringr::str_remove(\n                string = value, pattern = \"Fresh_\"\n            ),\n            value = case_when(\n                value == \"healthy\" ~ \"Healthy\",\n                TRUE ~ stringr::str_to_upper(value)\n            )\n        ) |>\n        dplyr::pull(value) |>\n        factor(\n            levels = c(\"Healthy\", \"ICM\", \"NICM\", \"HCM\")\n        ),\n    column_gap = grid::unit(0, \"mm\"),\n    #\n    show_heatmap_legend = TRUE,\n    heatmap_legend_param = list(\n        title = \"Z score\",\n        title_gp = grid::gpar(\n            fontfamily = \"Arial\",\n            fontsize = 6\n        ),\n        legend_direction = \"vertical\",\n        labels_gp = grid::gpar(\n            fontfamily = \"Arial\",\n            fontsize = 5\n        ),\n        legend_height = grid::unit(12, \"mm\"),\n        legend_width = grid::unit(4, \"mm\")\n    ),\n    #\n    use_raster = RASTERISED\n)\n\n\n# legend\nlgd_group <- ComplexHeatmap::Legend(\n    title = \"Group\",\n    labels = ha_group |> unique(),\n    legend_gp = grid::gpar(\n        fill = setNames(\n            object = as.character(yarrr::piratepal(palette = \"google\")),\n            nm = names(samples) |>\n                stringr::str_remove(pattern = \"fresh_\") |>\n                stringr::str_to_title()\n        )\n    ),\n    labels_gp = grid::gpar(\n        fontfamily = \"Arial\",\n        fontsize = 6\n    ),\n    title_gp = grid::gpar(\n        fontfamily = \"Arial\",\n        fontsize = 6\n    )\n)\n\npd <- ComplexHeatmap::packLegend(\n    lgd_group,\n    direction = \"vertical\"\n)\n\n\n# draw\nComplexHeatmap::draw(\n    ht,\n    heatmap_legend_list = list(pd)\n)"
  },
  {
    "objectID": "cardiomyopathy.html#go-enrichment",
    "href": "cardiomyopathy.html#go-enrichment",
    "title": "Accurate Classification of Cardiomyopathy Diagnosis by Chromatin Accessibility",
    "section": "GO enrichment",
    "text": "GO enrichment\n\n\nPlot\nData\n\n\n\n\nCodeenriched_go |>\n    dplyr::mutate(\n        category = factor(\n            category,\n            levels = c(\n                \"fresh_healthy\",\n                \"fresh_icm\",\n                \"fresh_nicm\",\n                \"fresh_hcm\"\n            )\n        ),\n        rank = factor(rank, levels = 5:1)\n    ) |>\n    ggplot2::ggplot(\n        ggplot2::aes(\n            x = p_value_log,\n            y = rank,\n            fill = category,\n        )\n    ) +\n    ggplot2::geom_bar(stat = \"identity\") +\n    ggplot2::facet_wrap(\n        ggplot2::vars(category),\n        ncol = 1,\n        strip.position = \"left\",\n        scales = \"free_x\",\n        labeller = ggplot2::labeller(\n            category = c(\n                \"fresh_healthy\" = \"Healthy\",\n                \"fresh_icm\" = \"ICM\",\n                \"fresh_nicm\" = \"NICM\",\n                \"fresh_hcm\" = \"HCM\"\n            )\n        )\n    ) +\n    ggplot2::geom_text(\n        ggplot2::aes(\n            x = 0,\n            label = term,\n            group = NULL\n        ),\n        size = 6 / ggplot2::.pt,\n        family = \"Arial\",\n        color = \"black\",\n        data = enriched_go |>\n            dplyr::mutate(\n                term = stringr::str_replace(\n                    string = term,\n                    pattern = \"organization\",\n                    replacement = \"org.\"\n                ),\n                category = factor(\n                    category,\n                    levels = c(\n                        \"fresh_healthy\",\n                        \"fresh_icm\",\n                        \"fresh_nicm\",\n                        \"fresh_hcm\"\n                    )\n                ),\n                rank = factor(rank, levels = 5:1),\n                term = paste(\" \", term)\n            ),\n        hjust = 0\n    ) +\n    ggplot2::scale_x_continuous(\n        name = expression(paste(\"-log\"[10], \" p\")),\n        labels = scales::math_format(10^.x)\n    ) +\n    ggplot2::scale_y_discrete(name = NULL) +\n    ggplot2::scale_fill_manual(\n        values = as.character(yarrr::piratepal(palette = \"google\"))\n    ) +\n    ggplot2::guides(fill = \"none\") +\n    ggplot2::theme_light() %+replace%\n    ggplot2::theme(\n        axis.title = ggplot2::element_blank(),\n        axis.text.x = ggplot2::element_text(family = \"Arial\", size = 7),\n        axis.text.y = ggplot2::element_blank(),\n        axis.ticks.y = ggplot2::element_blank(),\n        panel.background = ggplot2::element_blank(),\n        strip.text = ggplot2::element_text(\n            family = \"Arial\", size = 7,\n            margin = ggplot2::margin(\n                t = 4.4, r = 4.4, b = 4.4, l = 4.4, unit = \"pt\"\n            )\n        )\n    )\n\n\n\n\n\n\n\n\n\n\nenriched_go |> knitr::kable()\n\n\n\n\n\n\n\n\n\n\n\ncategory\nrank\ngo_id\nterm\np_value\np_value_log\n\n\n\nfresh_healthy\n1\nGO:0009653\nanatomical structure morphogenesis\n0.0e+00\n13.552842\n\n\nfresh_healthy\n2\nGO:0048468\ncell development\n0.0e+00\n12.721246\n\n\nfresh_healthy\n3\nGO:0006928\nmovement of cell or subcellular component\n0.0e+00\n11.657577\n\n\nfresh_healthy\n4\nGO:0023052\nsignaling\n0.0e+00\n10.886057\n\n\nfresh_icm\n1\nGO:0030029\nactin filament-based process\n0.0e+00\n22.136677\n\n\nfresh_icm\n2\nGO:0003012\nmuscle system process\n0.0e+00\n21.585027\n\n\nfresh_icm\n3\nGO:0006936\nmuscle contraction\n0.0e+00\n18.397940\n\n\nfresh_icm\n4\nGO:0061061\nmuscle structure development\n0.0e+00\n18.251812\n\n\nfresh_nicm\n1\nGO:0007155\ncell adhesion\n0.0e+00\n10.657577\n\n\nfresh_nicm\n2\nGO:0007275\nmulticellular organism development\n0.0e+00\n9.602060\n\n\nfresh_nicm\n3\nGO:0016477\ncell migration\n0.0e+00\n9.229148\n\n\nfresh_nicm\n4\nGO:0120036\nplasma membrane bounded cell projection organization\n1.0e-07\n6.853872\n\n\nfresh_hcm\n1\nGO:0034332\nadherens junction organization\n5.3e-05\n4.275724\n\n\nfresh_hcm\n2\nGO:0072073\nkidney epithelium development\n2.4e-04\n3.619789\n\n\nfresh_hcm\n3\nGO:0034330\ncell junction organization\n3.0e-04\n3.522879\n\n\nfresh_hcm\n4\nGO:0032502\ndevelopmental process\n3.4e-04\n3.468521"
  },
  {
    "objectID": "cardiomyopathy.html#embedding",
    "href": "cardiomyopathy.html#embedding",
    "title": "Accurate Classification of Cardiomyopathy Diagnosis by Chromatin Accessibility",
    "section": "Embedding",
    "text": "Embedding\n\nSEED <- 20220408\n\ncolor_palette_group <- setNames(\n    object = as.character(yarrr::piratepal(palette = \"google\")),\n    nm = c(\"Healthy\", \"ICM\", \"NICM\", \"HCM\")\n)\n\nmatrix_cpm_use <- t(\n    t(matrix_readcount_use) / colSums(matrix_readcount_use)\n) * 1e+06\n\n\nembedding <- purrr::map(\n    list(rownames(matrix_cpm_use), features_selected), \\(x) {\n        matrix_umap <- matrix_cpm_use[x, unlist(samples)]\n        matrix_umap <- matrix_umap[rowSums(matrix_umap) >= 30, ]\n        matrix_umap <- log1p(matrix_umap)\n        matrix_umap <- t(\n            scale(t(matrix_umap), center = TRUE, scale = TRUE)\n        )\n\n        set.seed(seed = SEED)\n        embedding_umap <- uwot::umap(\n            X = t(matrix_umap),\n            n_neighbors = 10,\n            n_components = 2,\n            metric = \"euclidean\",\n            spread = 1,\n            min_dist = 0.01,\n            n_threads = 1,\n            verbose = TRUE\n        )\n    }\n) |>\n    purrr::reduce(cbind) |>\n    as.data.frame() |>\n    tibble::rownames_to_column(var = \"sample\") |>\n    dplyr::rename(\n        \"x_umap1\" = \"V1\",\n        \"y_umap1\" = \"V2\",\n        \"x_umap2\" = \"V3\",\n        \"y_umap2\" = \"V4\"\n    ) |>\n    dplyr::mutate(\n        category = case_when(\n            sample %in% samples$fresh_healthy ~ \"Healthy\",\n            sample %in% samples$fresh_icm ~ \"ICM\",\n            sample %in% samples$fresh_nicm ~ \"NICM\",\n            sample %in% samples$fresh_hcm ~ \"HCM\"\n        ),\n        category = factor(\n            category,\n            levels = c(\"Healthy\", \"ICM\", \"NICM\", \"HCM\")\n        )\n    )\n\n22:46:16 UMAP embedding parameters a = 1.896 b = 0.8006\n\n\n22:46:16 Read 42 rows and found 205154 numeric columns\n\n\n22:46:16 Using FNN for neighbor search, n_neighbors = 10\n\n\n22:46:17 Commencing smooth kNN distance calibration using 1 thread with target n_neighbors = 10\n22:46:17 Initializing from normalized Laplacian + noise (using irlba)\n22:46:17 Commencing optimization for 500 epochs, with 552 positive edges\n22:46:18 Optimization finished\n22:46:18 UMAP embedding parameters a = 1.896 b = 0.8006\n22:46:18 Read 42 rows and found 5751 numeric columns\n22:46:18 Using FNN for neighbor search, n_neighbors = 10\n22:46:18 Commencing smooth kNN distance calibration using 1 thread with target n_neighbors = 10\n22:46:19 Initializing from normalized Laplacian + noise (using irlba)\n22:46:19 Commencing optimization for 500 epochs, with 416 positive edges\n22:46:19 Optimization finished\n\n\n\nGEOM_POINT_SIZE <- 2\nEMBEDDING_TITLE_PREFIX <- \"UMAP\"\n\npurrr::map2(\n    list(\"1\", \"2\"),\n    list(nrow(matrix_cpm_use), length(features_selected)), \\(x, y) {\n        plot_embedding(\n            data = embedding[, paste0(c(\"x_umap\", \"y_umap\"), x)],\n            color = embedding$category |> as.factor(),\n            label = glue::glue(\"{EMBEDDING_TITLE_PREFIX}; {y}\"),\n            label_position = NULL,\n            show_color_value_labels = FALSE,\n            show_color_legend = FALSE,\n            geom_point_size = GEOM_POINT_SIZE,\n            sort_values = FALSE,\n            rasterise = FALSE\n        ) +\n            scale_color_manual(\n                values = color_palette_group\n            ) +\n            theme_customized_embedding()\n    }\n) |>\n    purrr::reduce(`+`) +\n    patchwork::plot_layout(ncol = 2) +\n    patchwork::plot_annotation(\n        theme = ggplot2::theme(plot.margin = ggplot2::margin())\n    )"
  },
  {
    "objectID": "cardiomyopathy.html#prediction",
    "href": "cardiomyopathy.html#prediction",
    "title": "Accurate Classification of Cardiomyopathy Diagnosis by Chromatin Accessibility",
    "section": "Prediction",
    "text": "Prediction\n\nN_REPLICATES <- 100\nN_SAMPLES_TEST <- 2\n\nAUC; multiple\n\n\n\n76 M\n\nmatrix_rf_core_set <- matrix_cpm_use[\n    rownames(matrix_cpm_use) %in% features_selected,\n    unlist(samples)\n] |>\n    t() |>\n    as.matrix() |>\n    as.data.frame() |>\n    tibble::rownames_to_column(var = \"sample\") |>\n    dplyr::mutate(\n        group = case_when(\n            sample %in% samples_fresh_healthy ~ \"healthy\",\n            sample %in% samples_fresh_icm ~ \"icm\",\n            sample %in% samples_fresh_nicm ~ \"nicm\",\n            sample %in% samples_fresh_hcm ~ \"hcm\"\n        ),\n        group = factor(\n            group,\n            levels = c(\"healthy\", \"icm\", \"nicm\", \"hcm\")\n        )\n    )\n\nrownames(matrix_rf_core_set) <- matrix_rf_core_set$sample\nmatrix_rf_core_set$sample <- NULL\ncolnames(matrix_rf_core_set) <- make.names(\n    colnames(matrix_rf_core_set)\n)\n\n# sanity check\nstopifnot(\n    class(matrix_rf_core_set) == \"data.frame\"\n)\n\n\n\n\n\nroc_data <- purrr::map(seq_len(N_REPLICATES), \\(x) {\n    # roc_data <- furrr::future_map(seq_len(N_REPLICATES), \\(x) {\n    samples_test <- purrr::map(samples, \\(x) {\n        sample(\n            stringr::str_remove(\n                string = x,\n                pattern = \"_[1|2]\"\n            ) |> unique(),\n            N_SAMPLES_TEST\n        )\n    })\n\n    samples_test <- unlist(samples)[unlist(samples) |>\n        stringr::str_remove(\n            pattern = \"_[1|2]\"\n        ) %in% unlist(samples_test)]\n\n    matrix_rf_core_set_test <- matrix_rf_core_set[samples_test, ]\n    matrix_rf_core_set_train <- matrix_rf_core_set[\n        !rownames(matrix_rf_core_set) %in% samples_test,\n    ]\n\n    rf_model <- randomForest::randomForest(\n        group ~ .,\n        data = matrix_rf_core_set_train[\n            , !colnames(matrix_rf_core_set_train) %in% c(\"sample\"),\n        ],\n        ntree = 1000\n    )\n    rf_prediction <- predict(\n        rf_model,\n        matrix_rf_core_set_test,\n        type = \"prob\"\n    )\n\n    roc_rf <- pROC::multiclass.roc(\n        matrix_rf_core_set_test$group,\n        rf_prediction[, 2]\n    )\n\n    cat(\n        nrow(matrix_rf_core_set_test),\n        nrow(matrix_rf_core_set_train),\n        pROC::auc(roc_rf),\n        \"\\n\"\n    )\n\n    return(roc_rf)\n})\nnames(roc_data) <- seq_len(N_REPLICATES)\n\n\n\n\n\nroc_data <- format_roc(roc_data = roc_data)\nroc_averaged <- average_roc(roc_data = roc_data)\n\n20 M\n\nlibrary_size <- tibble::tribble(\n    ~sample, ~num_reads,\n    \"F1_1\", 60964390,\n    \"F1_2\", 57968864,\n    \"F2_1\", 54158970,\n    \"F2_2\", 143929746,\n    \"F5_1\", 55528072,\n    \"F5_2\", 64044782,\n    \"P3_1\", 78506662,\n    \"P3_2\", 80161416,\n    \"P5_1\", 100592008,\n    \"P5_2\", 99926658,\n    \"P6_1\", 74427936,\n    \"P6_2\", 74223738,\n    \"P104a_1\", 61766652,\n    \"P104a_2\", 71350414,\n    \"P117b_1\", 66442460,\n    \"P117b_2\", 76837402,\n    \"P123b_1\", 80766906,\n    \"P123b_2\", 82552378,\n    \"P131a_1\", 88475442,\n    \"P131a_2\", 68512592,\n    \"P92a_1\", 99683410,\n    \"P92a_2\", 74318972,\n    \"P114b_1\", 69490016,\n    \"P114b_2\", 74175524,\n    \"P59a_1\", 72517888,\n    \"P59a_2\", 75524788,\n    \"P60a_1\", 75844218,\n    \"P60a_2\", 77979036,\n    \"P73a_1\", 109707158,\n    \"P73a_2\", 81454894,\n    \"P87a_1\", 68502630,\n    \"P87a_2\", 52512570,\n    \"HOCM4_1\", 63494724,\n    \"HOCM4_2\", 64409436,\n    \"HOCM6_1\", 64873814,\n    \"HOCM6_2\", 80750200,\n    \"HOCM9_1\", 81728322,\n    \"HOCM9_2\", 74958418,\n    \"HOCM11_1\", 65222662,\n    \"HOCM11_2\", 77667354,\n    \"HOCM7_1\", 69229542,\n    \"HOCM7_2\", 80768964\n)\n\nlibrary_size <- setNames(\n    object = library_size$num_reads,\n    nm = library_size$sample\n)\n\n\nTARGET_NUM_READS <- 20000000\n\n\nroc_data <- purrr::map(seq_len(N_REPLICATES), \\(x) {\n    # roc_data <- furrr::future_map(seq_len(N_REPLICATES), \\(x) {\n    samples_test <- purrr::map(samples, \\(x) {\n        sample(\n            stringr::str_remove(\n                string = x,\n                pattern = \"_[1|2]\"\n            ) |> unique(),\n            N_SAMPLES_TEST\n        )\n    })\n\n    samples_test <- unlist(samples)[unlist(samples) |>\n        stringr::str_remove(\n            pattern = \"_[1|2]\"\n        ) %in% unlist(samples_test)]\n\n    matrix_rf_core_set_train <- matrix_rf_core_set[\n        !rownames(matrix_rf_core_set) %in% samples_test,\n    ]\n\n    matrix_cpm_test <- downsample_matrix(\n        matrix = matrix_readcount_use[, samples_test],\n        proportion = TARGET_NUM_READS / library_size[samples_test],\n        seed = SEED\n    ) |>\n        as.matrix() |>\n        calc_cpm()\n\n    matrix_rf_core_set_test <- matrix_cpm_test[\n        rownames(matrix_cpm_test) %in% features_selected,\n        unlist(samples_test)\n    ] |>\n        t() |>\n        as.matrix() |>\n        as.data.frame() |>\n        tibble::rownames_to_column(var = \"sample\") |>\n        dplyr::mutate(\n            group = case_when(\n                sample %in% samples_fresh_healthy ~ \"healthy\",\n                sample %in% samples_fresh_icm ~ \"icm\",\n                sample %in% samples_fresh_nicm ~ \"nicm\",\n                sample %in% samples_fresh_hcm ~ \"hcm\"\n            ),\n            group = factor(\n                group,\n                levels = c(\"healthy\", \"icm\", \"nicm\", \"hcm\")\n            )\n        )\n\n    rownames(matrix_rf_core_set_test) <- matrix_rf_core_set_test$sample\n    matrix_rf_core_set_test$sample <- NULL\n    colnames(matrix_rf_core_set_test) <- make.names(\n        colnames(matrix_rf_core_set_test)\n    )\n\n    class(matrix_rf_core_set_test)\n    matrix_rf_core_set_test[1:5, 1:5]\n\n    rf_model <- randomForest::randomForest(\n        group ~ .,\n        data = matrix_rf_core_set_train[\n            ,\n            !colnames(matrix_rf_core_set_train) %in% c(\"sample\"),\n        ],\n        ntree = 1000\n    )\n    rf_prediction <- predict(\n        rf_model,\n        matrix_rf_core_set_test,\n        type = \"prob\"\n    )\n\n    roc_rf <- pROC::multiclass.roc(\n        matrix_rf_core_set_test$group, rf_prediction[, 2]\n    )\n\n    cat(\n        nrow(matrix_rf_core_set_test),\n        nrow(matrix_rf_core_set_train),\n        pROC::auc(roc_rf),\n        \"\\n\"\n    )\n\n    return(roc_rf)\n})\nnames(roc_data) <- seq_len(N_REPLICATES)\n\n\n\n\n\nroc_data <- format_roc(roc_data = roc_data)\nroc_averaged_downsampled <- average_roc(roc_data = roc_data)\n\n\n\n\n\nplot_roc_curve_two(\n    data = list(roc_averaged, roc_averaged_downsampled),\n    label = c(\"76 M\", \"20 M\")\n)\n\n\n\n\n\n\n\n\n\n\nConstruct model\n\n\n\nBuild\n\nmatrix_rf_train <- matrix_cpm_use[\n    rownames(matrix_cpm_use) %in% features_selected,\n    c(\n        samples_fresh_healthy,\n        samples_fresh_icm,\n        samples_fresh_nicm,\n        samples_fresh_hcm\n    )\n]\n\nmatrix_rf_train <- matrix_rf_train |>\n    t() |>\n    as.matrix() |>\n    as.data.frame() |>\n    tibble::rownames_to_column(var = \"sample\") |>\n    dplyr::mutate(\n        group = case_when(\n            sample %in% samples_fresh_healthy ~ \"healthy\",\n            sample %in% samples_fresh_icm ~ \"icm\",\n            sample %in% samples_fresh_nicm ~ \"nicm\",\n            sample %in% samples_fresh_hcm ~ \"hcm\"\n        ),\n        group = factor(\n            group,\n            levels = c(\"healthy\", \"icm\", \"nicm\", \"hcm\")\n        )\n    )\n\nrownames(matrix_rf_train) <- matrix_rf_train$sample\nmatrix_rf_train$sample <- NULL\ncolnames(matrix_rf_train) <- make.names(colnames(matrix_rf_train))\n\n# sanity check\nstopifnot(\n    class(matrix_rf_train) == \"data.frame\"\n)\n\n\nset.seed(seed = SEED)\nrf_model <- randomForest::randomForest(\n    group ~ .,\n    data = matrix_rf_train[\n        ,\n        !colnames(matrix_rf_train) %in% c(\"sample\"),\n    ],\n    ntree = 1000\n)\n\nPredict\n\nsamples_selected <- tibble::tribble(\n    ~sample, ~ratio,\n    \"P97a_1\", 0.3677451197,\n    \"P97a_2\", 0.396041047,\n    \"P141a_1\", 0.208162124,\n    \"P141a_2\", 0.312910588,\n    \"MYEC4_2\", 0.320481892,\n    \"P108b_1\", 0.239929499,\n    \"P108b_2\", 0.321824834\n)\n\nmatrix_readcount_p1 <- matrix_readcount_use[\n    ,\n    c(\"F1_1\", \"P92a_1\", \"P59a_1\", \"HOCM4_1\")\n]\n\nmatrix_readcount_p2 <- purrr::map(\n    seq_len(nrow(samples_selected)), \\(x) {\n        downsample_matrix(\n            matrix_readcount_use[\n                , samples_selected[x, \"sample\", drop = TRUE],\n                drop = FALSE\n            ],\n            proportion = c(samples_selected[x, \"ratio\", drop = TRUE])\n        )\n    }\n) |>\n    purrr::reduce(cbind)\n\nmatrix_rf_test <- calc_cpm(\n    cbind(\n        matrix_readcount_p1,\n        matrix_readcount_p2\n    )\n)[\n    rownames(matrix_readcount_use) %in% features_selected,\n]\n\nmatrix_rf_test <- matrix_rf_test |>\n    t() |>\n    as.matrix() |>\n    as.data.frame() |>\n    tibble::rownames_to_column(var = \"sample\")\n\nrownames(matrix_rf_test) <- matrix_rf_test$sample\nmatrix_rf_test$sample <- NULL\ncolnames(matrix_rf_test) <- make.names(colnames(matrix_rf_test))\n\nrf_prediction <- predict(rf_model, matrix_rf_test, type = \"prob\")\n\nVisualize\nHeatmap\n\n\n\n\n# horizontal\nht <- ComplexHeatmap::Heatmap(\n    matrix = matrix_heatmap |> as.matrix() |> t(),\n    col = wesanderson::wes_palette(\"Zissou1\", 50, type = \"continuous\"),\n    #\n    cluster_rows = FALSE,\n    show_row_dend = FALSE,\n    cluster_columns = FALSE,\n    show_column_dend = FALSE,\n    #\n    show_row_names = TRUE,\n    row_labels = colnames(matrix_heatmap),\n    row_names_side = c(\"left\"),\n    row_names_gp = grid::gpar(fontfamily = \"Arial\", fontsize = 6),\n    #\n    show_column_names = TRUE,\n    column_names_side = c(\"bottom\"),\n    column_names_gp = grid::gpar(fontfamily = \"Arial\", fontsize = 6),\n    column_names_rot = 90,\n    #\n    show_heatmap_legend = TRUE,\n    heatmap_legend_param = list(\n        title = \"Score\",\n        title_gp = grid::gpar(\n            fontfamily = \"Arial\",\n            fontsize = 6\n        ),\n        legend_direction = \"vertical\",\n        labels_gp = grid::gpar(\n            fontfamily = \"Arial\",\n            fontsize = 5\n        ),\n        legend_height = grid::unit(12.5, \"mm\"),\n        legend_width = grid::unit(1, \"mm\")\n    ),\n)\n\n\n# draw\nComplexHeatmap::draw(ht)\n\n\n\n\n\n\n\n\n\n\nRadar plot\n\n\n\n\n\n\n\npurrr::map(rownames(matrix_heatmap), \\(x) {\n    data <- matrix_heatmap[\n        x, c(\"HCM     \", \"Healthy\", \"     ICM\", \"NICM\"),\n        drop = FALSE\n    ]\n    data <- data * 100\n\n    plot_radar(data)\n}) |>\n    purrr::reduce(`+`) +\n    patchwork::plot_layout(ncol = 3)"
  },
  {
    "objectID": "matrix.html#preparation",
    "href": "matrix.html#preparation",
    "title": "Genome-Wide Chromatin Accessibility Matrix",
    "section": "Preparation",
    "text": "Preparation\n\nPROJECT_DIR <- file.path(\n    \"/Users/jialei/Dropbox/Data/Projects/UTSW\",\n    \"/Cardiomyopathy/atac-seq\"\n)\n\nFunctions\n\n\n\nLoad required packages.\n\nlibrary(tidyverse)\n## ── Attaching packages ────────────────────────────────── tidyverse 1.3.2.9000 ──\n## ✔ ggplot2   3.3.6.9000        ✔ dplyr     1.0.99.9000  \n## ✔ tibble    3.1.8.9001        ✔ stringr   1.4.1.9000   \n## ✔ tidyr     1.2.1.9000        ✔ forcats   0.5.2.9000   \n## ✔ readr     2.1.2.9000        ✔ lubridate 1.8.0.9000   \n## ✔ purrr     0.9000.0.9000     \n## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n## ✖ dplyr::filter() masks stats::filter()\n## ✖ dplyr::lag()    masks stats::lag()\nlibrary(Matrix)\n## \n## Attaching package: 'Matrix'\n## \n## The following objects are masked from 'package:tidyr':\n## \n##     expand, pack, unpack\nlibrary(patchwork)\nlibrary(extrafont)\n## Registering fonts with R\n\n\nsource(\n    file = file.path(\n        SCRIPT_DIR,\n        \"utilities.R\"\n    )\n)\n\n\n`%+replace%` <- ggplot2::`%+replace%`\n\n\n\n\n\n\n\nPython env\n\nnp <- reticulate::import(\"numpy\", convert = TRUE)\ncat(\"numpy version:\", np$`__version__`, \"\\n\")\n\nnumpy version: 1.22.4 \n\n\n\nreticulate::py_config()\n\npython:         /Users/jialei/.pyenv/shims/python\nlibpython:      /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/libpython3.9.dylib\npythonhome:     /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10:/Users/jialei/.pyenv/versions/mambaforge-4.10.3-10\nversion:        3.9.13 | packaged by conda-forge | (main, May 27 2022, 17:00:33)  [Clang 13.0.1 ]\nnumpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy\nnumpy_version:  1.22.4\nnumpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy\n\nNOTE: Python version was forced by RETICULATE_PYTHON"
  },
  {
    "objectID": "matrix.html#preprocessing",
    "href": "matrix.html#preprocessing",
    "title": "Genome-Wide Chromatin Accessibility Matrix",
    "section": "Preprocessing",
    "text": "Preprocessing\nMatrix\n\n\n\n\n# load matrix\nfeature_counts_files <- list.files(\n    path = file.path(PROJECT_DIR, \"defined_peaks/summarize_counts\")\n)\n\nfeature_counts_files <- feature_counts_files[\n    stringr::str_detect(feature_counts_files, pattern = \"merged.+.bz2\")\n]\n\nmatrix_readcount_use <- purrr::map(feature_counts_files, \\(x) {\n    dt <- data.table::fread(\n        file = file.path(PROJECT_DIR, \"defined_peaks/summarize_counts\", x)\n    )\n\n    features <- dt[[\"Geneid\"]]\n    dt <- dt[, .SD, .SDcols = patterns(\"/project\")]\n    colnames(dt) <- stringr::str_remove(\n        string = colnames(dt),\n        pattern = \"_atacseq/alignments/Aligned_sorted_deduped_q10.bam\"\n    ) |>\n        stringr::str_remove(pattern = \"^.+/\")\n\n    m <- as.matrix(dt, sparse = TRUE)\n    rownames(m) <- features\n\n    return(m)\n})\n\nmatrix_readcount_use <- purrr::reduce(matrix_readcount_use, cbind)\ndim(matrix_readcount_use)\n\n[1] 207021     87\n\n\n\n# rename samples\nsample_ids <- tibble::tribble(\n    ~old, ~new,\n    \"heart_fresh1_1\", \"F1_1\",\n    \"heart_fresh1_2\", \"F1_2\",\n    \"heart_fresh2_1\", \"F2_1\",\n    \"heart_fresh2_2\", \"F2_2\",\n    \"heart_fresh5_1\", \"F5_1\",\n    \"heart_fresh5_2\", \"F5_2\",\n    \"heart_myectomy_p11_1\", \"HOCM11_1\",\n    \"heart_myectomy_p11_2\", \"HOCM11_2\",\n    \"heart_myectomy_p7_1\", \"HOCM7_1\",\n    \"heart_myectomy_p7_2\", \"HOCM7_2\",\n    #\n    \"heart_myectomy_p4_2\", \"MYEC4_2\"\n)\n\ncolnames(matrix_readcount_use) <- colnames(matrix_readcount_use) |>\n    tibble::enframe(value = \"sample\") |>\n    dplyr::left_join(sample_ids, by = c(\"sample\" = \"old\")) |>\n    dplyr::mutate(\n        new = case_when(\n            is.na(new) ~ sample,\n            TRUE ~ new\n        ),\n        new = stringr::str_remove(string = new, pattern = \"heart_\"),\n        #\n        new = case_when(\n            stringr::str_detect(\n                string = new,\n                pattern = \"[hocm|Hocm|MYEC]\"\n            ) ~ stringr::str_to_upper(new),\n            TRUE ~ stringr::str_to_title(new)\n        )\n    ) |>\n    dplyr::pull(new)\n\n\n# inspect matrix\nmatrix_readcount_use[1:5, 1:8]\n\n                F1_1 F1_2 F2_1 F2_2 F5_1 F5_2 P3_1 P3_2\n1_181358_181567    4    3    5   14   10   11    8    1\n1_183716_183885    4    4    6    9    2    7    3    5\n1_183999_184321    3    3    9   15    2   11    5   10\n1_191239_191880   19   17   24   28   14   28    9   10\n1_267894_268128    5    2   10   21    8   14    2    8\n\n\n\n\n\n\n# filter blocked regions\nblocked_regions <- read.table(\n    file = file.path(\n        dirname(PROJECT_DIR),\n        \"misc/annotations\",\n        \"ENCFF419RSJ.bed.gz\"\n    ),\n    stringsAsFactors = FALSE\n)\n\nblocked_regions <- GenomicRanges::GRanges(\n    blocked_regions[, 1],\n    IRanges::IRanges(blocked_regions[, 2] + 1, blocked_regions[, 3])\n)\n\nif (ensembldb::seqlevelsStyle(blocked_regions) == \"UCSC\") {\n    ensembldb::seqlevelsStyle(blocked_regions) <- \"Ensembl\"\n}\n\npeak_regions <- stringr::str_split(\n    string = rownames(matrix_readcount_use),\n    pattern = \"_\", simplify = TRUE\n) |>\n    as.data.frame()\npeak_regions <- GenomicRanges::GRanges(\n    peak_regions[, 1],\n    IRanges::IRanges(\n        as.numeric(peak_regions[, 2]) + 1,\n        as.numeric(peak_regions[, 3])\n    )\n)\n\nidy1 <- S4Vectors::queryHits(\n    GenomicRanges::findOverlaps(peak_regions, blocked_regions)\n)\n\nidy2 <- grep(\"Y|MT|GL|KI\", peak_regions)\nidy <- unique(c(idy1, idy2))\n\nmatrix_readcount_use <- matrix_readcount_use[-idy, ]\ndim(matrix_readcount_use)\n\n[1] 206024     87\n\n\n\n# sanity check\nstopifnot(\n    dim(matrix_readcount_use) == c(206024, 87)\n)\n\n\n# check memory usage\nwalk(list(matrix_readcount_use), \\(x) {\n    print(object.size(x), units = \"auto\", standard = \"SI\")\n})\n\n89.8 MB"
  },
  {
    "objectID": "matrix.html#r-session-info",
    "href": "matrix.html#r-session-info",
    "title": "Genome-Wide Chromatin Accessibility Matrix",
    "section": "R session info",
    "text": "R session info\n\ndevtools::session_info()\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.2.1 (2022-06-23)\n os       macOS Monterey 12.6\n system   aarch64, darwin21.6.0\n ui       unknown\n language (EN)\n collate  en_US.UTF-8\n ctype    en_US.UTF-8\n tz       America/Chicago\n date     2022-09-22\n pandoc   2.19.2 @ /opt/homebrew/bin/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package              * version       date (UTC) lib source\n AnnotationDbi          1.58.0        2022-04-26 [1] Bioconductor\n AnnotationFilter       1.20.0        2022-04-26 [1] Bioconductor\n assertthat             0.2.1         2019-03-21 [1] CRAN (R 4.2.0)\n Biobase                2.56.0        2022-04-26 [1] Bioconductor\n BiocFileCache          2.4.0         2022-04-26 [1] Bioconductor\n BiocGenerics           0.42.0        2022-04-26 [1] Bioconductor\n BiocIO                 1.6.0         2022-04-26 [1] Bioconductor\n BiocParallel           1.30.3        2022-06-05 [1] Bioconductor\n biomaRt                2.52.0        2022-04-26 [1] Bioconductor\n Biostrings             2.64.1        2022-08-18 [1] Bioconductor\n bit                    4.0.4         2020-08-04 [1] CRAN (R 4.2.0)\n bit64                  4.0.5         2020-08-30 [1] CRAN (R 4.2.0)\n bitops                 1.0-7         2021-04-24 [1] CRAN (R 4.2.0)\n blob                   1.2.3         2022-04-10 [1] CRAN (R 4.2.0)\n cachem                 1.0.6         2021-08-19 [1] CRAN (R 4.2.0)\n callr                  3.7.2         2022-08-22 [1] CRAN (R 4.2.1)\n cli                    3.4.0         2022-09-08 [1] CRAN (R 4.2.1)\n codetools              0.2-18        2020-11-04 [2] CRAN (R 4.2.1)\n colorspace             2.0-3         2022-02-21 [1] CRAN (R 4.2.0)\n crayon                 1.5.1         2022-03-26 [1] CRAN (R 4.2.0)\n curl                   4.3.2         2021-06-23 [1] CRAN (R 4.2.0)\n data.table             1.14.3        2022-09-12 [1] local\n DBI                    1.1.3         2022-06-18 [1] CRAN (R 4.2.0)\n dbplyr                 2.2.1         2022-06-27 [1] CRAN (R 4.2.1)\n DelayedArray           0.22.0        2022-04-26 [1] Bioconductor\n devtools               2.4.4.9000    2022-08-11 [1] Github (r-lib/devtools@c9696a6)\n digest                 0.6.29        2021-12-01 [1] CRAN (R 4.2.0)\n dplyr                * 1.0.99.9000   2022-09-21 [1] Github (tidyverse/dplyr@60f7a2d)\n ellipsis               0.3.2         2021-04-29 [1] CRAN (R 4.2.0)\n ensembldb              2.20.2        2022-06-16 [1] Bioconductor\n evaluate               0.16          2022-08-09 [1] CRAN (R 4.2.1)\n extrafont            * 0.18          2022-04-12 [1] CRAN (R 4.2.0)\n extrafontdb            1.0           2012-06-11 [1] CRAN (R 4.2.0)\n fansi                  1.0.3         2022-03-24 [1] CRAN (R 4.2.0)\n fastmap                1.1.0         2021-01-25 [1] CRAN (R 4.2.0)\n filelock               1.0.2         2018-10-05 [1] CRAN (R 4.2.0)\n forcats              * 0.5.2.9000    2022-08-20 [1] Github (tidyverse/forcats@bd319e0)\n fs                     1.5.2.9000    2022-08-24 [1] Github (r-lib/fs@238032f)\n generics               0.1.3         2022-07-05 [1] CRAN (R 4.2.1)\n GenomeInfoDb           1.32.4        2022-09-06 [1] Bioconductor\n GenomeInfoDbData       1.2.8         2022-04-22 [1] Bioconductor\n GenomicAlignments      1.32.1        2022-07-24 [1] Bioconductor\n GenomicFeatures        1.48.3        2022-05-31 [1] Bioconductor\n GenomicRanges          1.48.0        2022-04-26 [1] Bioconductor\n ggplot2              * 3.3.6.9000    2022-09-12 [1] Github (tidyverse/ggplot2@a58b48c)\n glue                   1.6.2.9000    2022-04-22 [1] Github (tidyverse/glue@d47d6c7)\n gtable                 0.3.1.9000    2022-09-01 [1] Github (r-lib/gtable@c1a7a81)\n hms                    1.1.2         2022-08-19 [1] CRAN (R 4.2.1)\n htmltools              0.5.3         2022-07-18 [1] CRAN (R 4.2.1)\n htmlwidgets            1.5.4         2022-08-23 [1] Github (ramnathv/htmlwidgets@400cf1a)\n httpuv                 1.6.6         2022-09-08 [1] CRAN (R 4.2.1)\n httr                   1.4.4         2022-08-17 [1] CRAN (R 4.2.1)\n IRanges                2.30.1        2022-08-18 [1] Bioconductor\n jsonlite               1.8.0         2022-02-22 [1] CRAN (R 4.2.0)\n KEGGREST               1.36.3        2022-07-12 [1] Bioconductor\n knitr                  1.40          2022-08-24 [1] CRAN (R 4.2.1)\n later                  1.3.0         2021-08-18 [1] CRAN (R 4.2.0)\n lattice                0.20-45       2021-09-22 [2] CRAN (R 4.2.1)\n lazyeval               0.2.2         2019-03-15 [1] CRAN (R 4.2.0)\n lifecycle              1.0.2.9000    2022-09-09 [1] Github (r-lib/lifecycle@a2666fc)\n lubridate            * 1.8.0.9000    2022-05-24 [1] Github (tidyverse/lubridate@0bb49b2)\n magrittr               2.0.3         2022-03-30 [1] CRAN (R 4.2.0)\n Matrix               * 1.5-1         2022-09-13 [1] CRAN (R 4.2.1)\n MatrixGenerics         1.8.1         2022-06-26 [1] Bioconductor\n matrixStats            0.62.0        2022-04-19 [1] CRAN (R 4.2.0)\n memoise                2.0.1         2021-11-26 [1] CRAN (R 4.2.0)\n mime                   0.12          2021-09-28 [1] CRAN (R 4.2.0)\n miniUI                 0.1.1.1       2018-05-18 [1] CRAN (R 4.2.0)\n munsell                0.5.0         2018-06-12 [1] CRAN (R 4.2.0)\n patchwork            * 1.1.2.9000    2022-08-20 [1] Github (thomasp85/patchwork@c14c960)\n pillar                 1.8.1         2022-08-19 [1] CRAN (R 4.2.1)\n pkgbuild               1.3.1         2021-12-20 [1] CRAN (R 4.2.0)\n pkgconfig              2.0.3         2019-09-22 [1] CRAN (R 4.2.0)\n pkgload                1.3.0         2022-06-27 [1] CRAN (R 4.2.1)\n png                    0.1-7         2013-12-03 [1] CRAN (R 4.2.0)\n prettyunits            1.1.1.9000    2022-04-22 [1] Github (r-lib/prettyunits@8706d89)\n processx               3.7.0         2022-07-07 [1] CRAN (R 4.2.1)\n profvis                0.3.7         2020-11-02 [1] CRAN (R 4.2.0)\n progress               1.2.2         2019-05-16 [1] CRAN (R 4.2.0)\n promises               1.2.0.1       2021-02-11 [1] CRAN (R 4.2.0)\n ProtGenerics           1.28.0        2022-04-26 [1] Bioconductor\n ps                     1.7.1         2022-06-18 [1] CRAN (R 4.2.0)\n purrr                * 0.9000.0.9000 2022-09-21 [1] Github (tidyverse/purrr@194b8ef)\n R.cache                0.16.0        2022-07-21 [1] CRAN (R 4.2.1)\n R.methodsS3            1.8.2         2022-06-13 [1] CRAN (R 4.2.0)\n R.oo                   1.25.0        2022-06-12 [1] CRAN (R 4.2.0)\n R.utils                2.12.0        2022-06-28 [1] CRAN (R 4.2.1)\n R6                     2.5.1.9000    2022-08-04 [1] Github (r-lib/R6@87d5e45)\n ragg                   1.2.2.9000    2022-09-12 [1] Github (r-lib/ragg@904e145)\n rappdirs               0.3.3         2021-01-31 [1] CRAN (R 4.2.0)\n Rcpp                   1.0.9         2022-07-08 [1] CRAN (R 4.2.1)\n RCurl                  1.98-1.8      2022-07-30 [1] CRAN (R 4.2.1)\n readr                * 2.1.2.9000    2022-09-20 [1] Github (tidyverse/readr@5cac6ed)\n remotes                2.4.2         2022-09-12 [1] Github (r-lib/remotes@bc0949d)\n restfulr               0.0.15        2022-06-16 [1] CRAN (R 4.2.0)\n reticulate             1.26          2022-08-31 [1] CRAN (R 4.2.1)\n rjson                  0.2.21        2022-01-09 [1] CRAN (R 4.2.0)\n rlang                  1.0.5.9000    2022-09-16 [1] Github (r-lib/rlang@5a25ff4)\n rmarkdown              2.16.1        2022-08-25 [1] Github (rstudio/rmarkdown@b8a9879)\n Rsamtools              2.12.0        2022-04-26 [1] Bioconductor\n RSQLite                2.2.17        2022-09-10 [1] CRAN (R 4.2.1)\n rtracklayer            1.56.1        2022-06-23 [1] Bioconductor\n Rttf2pt1               1.3.10        2022-02-07 [1] CRAN (R 4.2.0)\n S4Vectors              0.34.0        2022-04-26 [1] Bioconductor\n scales                 1.2.1.9000    2022-08-20 [1] Github (r-lib/scales@b3df2fb)\n sessioninfo            1.2.2         2021-12-06 [1] CRAN (R 4.2.0)\n shiny                  1.7.2         2022-07-19 [1] CRAN (R 4.2.1)\n stringi                1.7.8         2022-07-11 [1] CRAN (R 4.2.1)\n stringr              * 1.4.1.9000    2022-08-21 [1] Github (tidyverse/stringr@792bc92)\n styler               * 1.7.0.9002    2022-09-21 [1] Github (r-lib/styler@1f4437b)\n SummarizedExperiment   1.26.1        2022-04-29 [1] Bioconductor\n systemfonts            1.0.4         2022-02-11 [1] CRAN (R 4.2.0)\n textshaping            0.3.6         2021-10-13 [1] CRAN (R 4.2.0)\n tibble               * 3.1.8.9001    2022-09-20 [1] Github (tidyverse/tibble@b740af1)\n tidyr                * 1.2.1.9000    2022-09-09 [1] Github (tidyverse/tidyr@653def2)\n tidyselect             1.1.2.9000    2022-09-21 [1] Github (r-lib/tidyselect@edd0a3b)\n tidyverse            * 1.3.2.9000    2022-09-12 [1] Github (tidyverse/tidyverse@3be8283)\n tzdb                   0.3.0         2022-03-28 [1] CRAN (R 4.2.0)\n urlchecker             1.0.1         2021-11-30 [1] CRAN (R 4.2.0)\n usethis                2.1.6.9000    2022-09-15 [1] Github (r-lib/usethis@7c34252)\n utf8                   1.2.2         2021-07-24 [1] CRAN (R 4.2.0)\n vctrs                  0.4.1.9000    2022-09-19 [1] Github (r-lib/vctrs@0a219ba)\n withr                  2.5.0         2022-03-03 [1] CRAN (R 4.2.0)\n xfun                   0.33          2022-09-12 [1] CRAN (R 4.2.1)\n XML                    3.99-0.10     2022-06-09 [1] CRAN (R 4.2.0)\n xml2                   1.3.3         2021-11-30 [1] CRAN (R 4.2.0)\n xtable                 1.8-4         2019-04-21 [1] CRAN (R 4.2.0)\n XVector                0.36.0        2022-04-26 [1] Bioconductor\n yaml                   2.3.5         2022-02-21 [1] CRAN (R 4.2.0)\n zlibbioc               1.42.0        2022-04-26 [1] Bioconductor\n\n [1] /opt/homebrew/lib/R/4.2/site-library\n [2] /opt/homebrew/Cellar/r/4.2.1_4/lib/R/library\n\n─ Python configuration ───────────────────────────────────────────────────────\n python:         /Users/jialei/.pyenv/shims/python\n libpython:      /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/libpython3.9.dylib\n pythonhome:     /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10:/Users/jialei/.pyenv/versions/mambaforge-4.10.3-10\n version:        3.9.13 | packaged by conda-forge | (main, May 27 2022, 17:00:33)  [Clang 13.0.1 ]\n numpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy\n numpy_version:  1.22.4\n numpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy\n \n NOTE: Python version was forced by RETICULATE_PYTHON\n\n──────────────────────────────────────────────────────────────────────────────"
  },
  {
    "objectID": "dataset.html",
    "href": "dataset.html",
    "title": "Dataset Summary",
    "section": "",
    "text": "Table\nData\n\n\n\n\nCodedataset |>\n    dplyr::group_by(category) |>\n    dplyr::mutate(\n        num_reads_uniq_percentage = num_reads_uniq / num_reads_trimmed,\n        num_reads_uniq_percentage_all = num_reads_uniq / num_reads_raw,\n        #\n        num_reads_deduped_percentage = num_reads_deduped / num_reads_uniq,\n        num_reads_deduped_percentage_all = num_reads_deduped / num_reads_raw,\n        #\n        num_reads_q10_percentage = num_reads_q10 / num_reads_deduped,\n        num_reads_q10_percentage_all = num_reads_q10 / num_reads_raw,\n    ) |>\n    dplyr::summarise(\n        # num_samples = dplyr::n(),\n        median_reads = median(num_reads_raw),\n        median_reads_trimmed = median(num_reads_trimmed),\n        #\n        median_reads_uniq = median(num_reads_uniq),\n        median_reads_uniq_percentage = median(num_reads_uniq_percentage),\n        median_reads_uniq_percentage_all = median(\n            num_reads_uniq_percentage_all\n        ),\n        #\n        median_reads_deduped = median(num_reads_deduped),\n        median_reads_deduped_percentage = median(num_reads_deduped_percentage),\n        median_reads_deduped_percentage_all = median(\n            num_reads_deduped_percentage_all\n        ),\n        #\n        median_reads_q10 = median(num_reads_q10),\n        median_reads_q10_percentage = median(num_reads_q10_percentage),\n        median_reads_q10_percentage_all = median(\n            num_reads_q10_percentage_all\n        ),\n    ) |>\n    dplyr::mutate(\n        category = factor(\n            category,\n            levels = c(\"Healthy\", \"ICM\", \"NICM\", \"HCM\")\n        )\n    ) |>\n    dplyr::arrange(category) |>\n    gt::gt() |>\n    gt::tab_header(\n        title = gt::md(\"**Dataset Summary**\")\n    ) |>\n    gt::tab_spanner(\n        label = \"No. reads\",\n        columns = c(median_reads, median_reads_trimmed)\n    ) |>\n    gt::tab_spanner(\n        label = \"Unique alignment\",\n        columns = c(\n            median_reads_uniq,\n            median_reads_uniq_percentage,\n            median_reads_uniq_percentage_all\n        )\n    ) |>\n    gt::tab_spanner(\n        label = \"Q10\",\n        columns = c(\n            median_reads_q10,\n            median_reads_q10_percentage,\n            median_reads_q10_percentage_all\n        )\n    ) |>\n    gt::tab_spanner(\n        label = \"Duplicate removal\",\n        columns = median_reads_deduped:median_reads_deduped_percentage_all\n    ) |>\n    gt::tab_footnote(\n        footnote = gt::md(\"Median of each group\"),\n        locations = gt::cells_column_spanners(\n            spanners = c(\n                \"No. reads\",\n                \"Unique alignment\",\n                \"Duplicate removal\",\n                \"Q10\"\n            )\n        )\n    ) |>\n    gt::tab_footnote(\n        footnote = gt::md(\"Percentage of `Trimmed` reads\"),\n        locations = gt::cells_column_labels(\n            columns = median_reads_uniq_percentage\n        )\n    ) |>\n    gt::tab_footnote(\n        footnote = gt::md(\"Percentage of total `Raw` reads\"),\n        locations = gt::cells_column_labels(\n            columns = median_reads_uniq_percentage_all\n        )\n    ) |>\n    gt::tab_footnote(\n        footnote = gt::md(\"Percentage of `Unique alignment` reads\"),\n        locations = gt::cells_column_labels(\n            columns = median_reads_deduped_percentage\n        )\n    ) |>\n    gt::tab_footnote(\n        footnote = gt::md(\"Percentage of total `Raw` reads\"),\n        locations = gt::cells_column_labels(\n            columns = median_reads_deduped_percentage_all\n        )\n    ) |>\n    gt::tab_footnote(\n        footnote = gt::md(\n            \"Percentage of `Duplicate removal` reads\"\n        ),\n        locations = gt::cells_column_labels(\n            columns = median_reads_q10_percentage\n        )\n    ) |>\n    gt::tab_footnote(\n        footnote = gt::md(\"Percentage of total `Raw` reads\"),\n        locations = gt::cells_column_labels(\n            columns = median_reads_q10_percentage_all\n        )\n    ) |>\n    gt::fmt_number(\n        columns = c(\n            median_reads:median_reads_uniq,\n            median_reads_deduped,\n            median_reads_q10\n        ),\n        decimals = 2,\n        suffixing = TRUE\n    ) |>\n    gt::fmt_percent(\n        columns = c(\n            median_reads_uniq_percentage:median_reads_uniq_percentage_all,\n            median_reads_deduped_percentage:median_reads_deduped_percentage_all,\n            median_reads_q10_percentage:median_reads_q10_percentage_all\n        ),\n        decimals = 1\n    ) |>\n    gt::data_color(\n        columns = c(category),\n        colors = scales::col_factor(\n            palette = yarrr::piratepal(palette = \"google\") |> as.character(),\n            domain = NULL\n        )\n    ) |>\n    gt::cols_label(\n        category = \"\",\n        #\n        median_reads = \"Raw\",\n        median_reads_trimmed = \"Trimmed\",\n        #\n        median_reads_uniq = gt::html(\"#\"),\n        median_reads_uniq_percentage = gt::html(\"%\"),\n        median_reads_uniq_percentage_all = gt::html(\"%\"),\n        #\n        median_reads_deduped = gt::html(\"#\"),\n        median_reads_deduped_percentage = gt::html(\"%\"),\n        median_reads_deduped_percentage_all = gt::html(\"%\"),\n        #\n        median_reads_q10 = gt::html(\"#\"),\n        median_reads_q10_percentage = gt::html(\"%\"),\n        median_reads_q10_percentage_all = gt::html(\"%\"),\n    ) |>\n    gt::opt_footnote_marks(marks = \"extended\") |>\n    gt::tab_options() |>\n    gt::tab_style(\n        style = gt::cell_text(size = gt::pct(85)),\n        locations = list(\n            # gt::cells_title(),\n            gt::cells_column_spanners(spanners = gt::everything()),\n            gt::cells_body(), gt::cells_column_labels(),\n            gt::cells_footnotes()\n        )\n    )\n\n\n\n\n\n\nDataset Summary\n    \n\n\n\n      \n        No. reads*\n      \n      \n        Unique alignment*\n      \n      \n        Duplicate removal*\n      \n      \n        Q10*\n      \n    \n\nRaw\n      Trimmed\n      #\n      %†\n\n      %‡\n\n      #\n      %§\n\n      %‡\n\n      #\n      %‖\n\n      %‡\n\n    \n\n\n\nHealthy\n74.33M\n74.19M\n73.37M\n98.7%\n98.6%\n48.12M\n67.8%\n66.9%\n43.51M\n90.9%\n60.5%\n\n\nICM\n75.58M\n75.45M\n74.25M\n98.7%\n98.6%\n44.91M\n54.2%\n53.4%\n40.67M\n90.6%\n48.2%\n\n\nNICM\n74.85M\n74.71M\n73.32M\n98.4%\n98.3%\n45.81M\n62.8%\n61.6%\n41.42M\n90.4%\n55.6%\n\n\nHCM\n72.09M\n71.96M\n71.01M\n98.8%\n98.6%\n51.36M\n75.1%\n74.0%\n46.50M\n90.4%\n66.9%\n\n\n\n\n\n* Median of each group\n    \n\n\n† Percentage of Trimmed reads\n    \n\n\n‡ Percentage of total Raw reads\n    \n\n\n§ Percentage of Unique alignment reads\n    \n\n\n‖ Percentage of Duplicate removal reads\n    \n\n\n\n\n\n\n\n\n\n\n\nCodedataset |>\n    dplyr::select(sample, category, num_reads_raw, num_reads_q10) |>\n    dplyr::mutate(\n        ratio = num_reads_q10 / num_reads_raw,\n        category = factor(\n            category,\n            levels = c(\"Healthy\", \"ICM\", \"NICM\", \"HCM\")\n        )\n    ) |>\n    gt::gt() |>\n    gt::summary_rows(\n        columns = num_reads_raw:num_reads_q10,\n        fns = c(\n            Average = ~ mean(.)\n        ),\n        formatter = gt::fmt_number,\n        decimals = 2,\n        suffixing = TRUE\n    ) |>\n    gt::summary_rows(\n        columns = ratio,\n        fns = c(\n            Average = ~ mean(.)\n        ),\n        formatter = gt::fmt_percent,\n        decimals = 2\n    ) |>\n    gt::tab_spanner(\n        # label = \"No. reads\",\n        label = gt::md(\"**No. reads**\"),\n        columns = c(num_reads_raw, num_reads_q10)\n    ) |>\n    gt::tab_header(\n        title = gt::md(\"**Sample Overview**\")\n    ) |>\n    gt::data_color(\n        columns = c(category),\n        colors = scales::col_factor(\n            palette = yarrr::piratepal(palette = \"google\") |> as.character(),\n            domain = NULL\n        )\n    ) |>\n    gt::data_color(\n        columns = c(num_reads_raw),\n        colors = scales::col_numeric(\n            palette = c(\n                \"green\", \"orange\", \"red\"\n            ),\n            domain = NULL\n        )\n    ) |>\n    gt::data_color(\n        columns = c(ratio),\n        colors = scales::col_numeric(\n            palette = viridis::viridis(n = 5, option = \"F\"),\n            domain = NULL\n        )\n    ) |>\n    gt::fmt_number(\n        columns = c(num_reads_raw, num_reads_q10),\n        decimals = 2,\n        suffixing = TRUE\n    ) |>\n    gt::fmt_percent(\n        columns = c(ratio),\n        decimals = 1\n    ) |>\n    gt::cols_label(\n        sample = gt::md(\"**Sample**\"),\n        category = gt::md(\"Category\"),\n        num_reads_raw = gt::md(\"Raw\"),\n        num_reads_q10 = gt::md(\"Q10\"),\n        ratio = gt::md(\"Percentage\")\n    ) |>\n    gt::tab_options(\n        # table.background.color = gt::adjust_luminance(\"LemonChiffon\", steps = 2),\n        # table.background.color = gt::adjust_luminance(\"#FFEFE5\", steps = 2),\n        table.background.color = NULL,\n        grand_summary_row.background.color = \"lightblue\"\n    ) |>\n    gt::tab_style(\n        style = gt::cell_text(size = gt::pct(95)),\n        locations = list(\n            # gt::cells_title(),\n            gt::cells_column_spanners(spanners = gt::everything()),\n            gt::cells_body(), gt::cells_column_labels()\n        )\n    )\n\n\n\n\n\n\nSample Overview\n    \n\n\n\n      Sample\n      Category\n      \n        No. reads\n      \n      Percentage\n    \n\nRaw\n      Q10\n    \n\n\n\n\nF1_1\nHealthy\n60.96M\n39.41M\n64.6%\n\n\n\nF1_2\nHealthy\n57.97M\n39.01M\n67.3%\n\n\n\nF2_1\nHealthy\n54.16M\n36.17M\n66.8%\n\n\n\nF2_2\nHealthy\n143.93M\n80.99M\n56.3%\n\n\n\nF5_1\nHealthy\n55.53M\n37.15M\n66.9%\n\n\n\nF5_2\nHealthy\n64.04M\n46.27M\n72.2%\n\n\n\nP3_1\nHealthy\n78.51M\n43.62M\n55.6%\n\n\n\nP3_2\nHealthy\n80.16M\n42.48M\n53.0%\n\n\n\nP5_1\nHealthy\n100.59M\n44.28M\n44.0%\n\n\n\nP5_2\nHealthy\n99.93M\n43.40M\n43.4%\n\n\n\nP6_1\nHealthy\n74.43M\n45.71M\n61.4%\n\n\n\nP6_2\nHealthy\n74.22M\n44.25M\n59.6%\n\n\n\nP104a_1\nICM\n61.77M\n30.83M\n49.9%\n\n\n\nP104a_2\nICM\n71.35M\n32.92M\n46.1%\n\n\n\nP117b_1\nICM\n66.44M\n41.34M\n62.2%\n\n\n\nP117b_2\nICM\n76.84M\n46.66M\n60.7%\n\n\n\nP123b_1\nICM\n80.77M\n52.35M\n64.8%\n\n\n\nP123b_2\nICM\n82.55M\n54.31M\n65.8%\n\n\n\nP131a_1\nICM\n88.48M\n39.99M\n45.2%\n\n\n\nP131a_2\nICM\n68.51M\n29.84M\n43.6%\n\n\n\nP92a_1\nICM\n99.68M\n45.23M\n45.4%\n\n\n\nP92a_2\nICM\n74.32M\n34.56M\n46.5%\n\n\n\nP114b_1\nNICM\n69.49M\n37.01M\n53.3%\n\n\n\nP114b_2\nNICM\n74.18M\n39.39M\n53.1%\n\n\n\nP59a_1\nNICM\n72.52M\n47.01M\n64.8%\n\n\n\nP59a_2\nNICM\n75.52M\n53.73M\n71.1%\n\n\n\nP60a_1\nNICM\n75.84M\n40.87M\n53.9%\n\n\n\nP60a_2\nNICM\n77.98M\n40.17M\n51.5%\n\n\n\nP73a_1\nNICM\n109.71M\n57.57M\n52.5%\n\n\n\nP73a_2\nNICM\n81.45M\n46.64M\n57.3%\n\n\n\nP87a_1\nNICM\n68.50M\n41.96M\n61.3%\n\n\n\nP87a_2\nNICM\n52.51M\n30.55M\n58.2%\n\n\n\nHOCM4_1\nHCM\n63.49M\n44.04M\n69.4%\n\n\n\nHOCM4_2\nHCM\n64.41M\n43.67M\n67.8%\n\n\n\nHOCM6_1\nHCM\n64.87M\n37.19M\n57.3%\n\n\n\nHOCM6_2\nHCM\n80.75M\n47.82M\n59.2%\n\n\n\nHOCM9_1\nHCM\n81.73M\n60.28M\n73.8%\n\n\n\nHOCM9_2\nHCM\n74.96M\n49.82M\n66.5%\n\n\n\nHOCM11_1\nHCM\n65.22M\n45.17M\n69.3%\n\n\n\nHOCM11_2\nHCM\n77.67M\n52.24M\n67.3%\n\n\n\nHOCM7_1\nHCM\n69.23M\n42.03M\n60.7%\n\n\n\nHOCM7_2\nHCM\n80.77M\n48.10M\n59.6%\n\n\nAverage\n—\n—\n76.09M\n44.19M\n58.79%"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Accurate Classification of Cardiomyopathy Diagnosis by Chromatin Accessibility",
    "section": "",
    "text": "Workflow\n\n\nRapid diagnostic strategy for cardiomyopathy etiology\n\n\n\n\n Citation\n\nSamadrita Bhattacharyya#, Jialei Duan#, Ryan J. Vela, Minoti Bhakta, Pietro Bajona, Pradeep P.A. Mammen, Gary C. Hon* and Nikhil V. Munshi* (2022). Accurate Classification of Cardiomyopathy Diagnosis by Chromatin Accessibility. Circulation 146, 878–881. DOI: 10.1161/CIRCULATIONAHA.122.059659"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "from datetime import datetime\ndatetime.today().strftime(\"%Y-%m-%d %H:%M:%S\")\n\n'2022-09-22 22:11:05'"
  },
  {
    "objectID": "qc.html#preparation",
    "href": "qc.html#preparation",
    "title": "Quality Control",
    "section": "Preparation",
    "text": "Preparation\n\nPROJECT_DIR <- file.path(\n    \"/Users/jialei/Dropbox/Data/Projects/UTSW\",\n    \"/Cardiomyopathy/atac-seq\"\n)\n\nFunctions\n\n\n\nLoad required packages.\n\nlibrary(tidyverse)\n## ── Attaching packages ────────────────────────────────── tidyverse 1.3.2.9000 ──\n## ✔ ggplot2   3.3.6.9000        ✔ dplyr     1.0.99.9000  \n## ✔ tibble    3.1.8.9001        ✔ stringr   1.4.1.9000   \n## ✔ tidyr     1.2.1.9000        ✔ forcats   0.5.2.9000   \n## ✔ readr     2.1.2.9000        ✔ lubridate 1.8.0.9000   \n## ✔ purrr     0.9000.0.9000     \n## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n## ✖ dplyr::filter() masks stats::filter()\n## ✖ dplyr::lag()    masks stats::lag()\nlibrary(Matrix)\n## \n## Attaching package: 'Matrix'\n## \n## The following objects are masked from 'package:tidyr':\n## \n##     expand, pack, unpack\nlibrary(patchwork)\nlibrary(extrafont)\n## Registering fonts with R\n\n\nsource(\n    file = file.path(\n        SCRIPT_DIR,\n        \"utilities.R\"\n    )\n)\n\n\n`%+replace%` <- ggplot2::`%+replace%`\n\n\n\n\n\n\n\nPython env\n\nnp <- reticulate::import(\"numpy\", convert = TRUE)\ncat(\"numpy version:\", np$`__version__`, \"\\n\")\n\nnumpy version: 1.22.4 \n\n\n\nreticulate::py_config()\n\npython:         /Users/jialei/.pyenv/shims/python\nlibpython:      /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/libpython3.9.dylib\npythonhome:     /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10:/Users/jialei/.pyenv/versions/mambaforge-4.10.3-10\nversion:        3.9.13 | packaged by conda-forge | (main, May 27 2022, 17:00:33)  [Clang 13.0.1 ]\nnumpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy\nnumpy_version:  1.22.4\nnumpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy\n\nNOTE: Python version was forced by RETICULATE_PYTHON"
  },
  {
    "objectID": "qc.html#qc",
    "href": "qc.html#qc",
    "title": "Quality Control",
    "section": "QC",
    "text": "QC\nTSS enrichment score\n\n\nPlot\nData\n\n\n\n\nCodefs::dir_ls(\n    path = file.path(\n        PROJECT_DIR,\n        \"qc\",\n        \"tss_enrichment/raw/core_set_merged\",\n        \"cut_site\"\n    ),\n    regexp = \"npy$\"\n) |>\n    purrr::map(\\(x) {\n        np$load(file = x) |>\n            {\n                \\(y) {\n                    y / mean(c(y[1:100], y[4102:4201]))\n                }\n            }() |>\n            tibble::enframe(name = \"position\", value = \"score\") |>\n            dplyr::mutate(\n                category = x |>\n                    basename() |>\n                    stringr::str_remove(\n                        pattern = \"Aligned_sorted_deduped_q10_\"\n                    ) |>\n                    stringr::str_remove(\n                        pattern = \"_21_tss_flanking_0.npy\"\n                    )\n            )\n    }) |>\n    dplyr::bind_rows() |>\n    dplyr::mutate(\n        category = category |> stringr::str_to_title(),\n        category = dplyr::case_when(\n            category == \"Fresh_healthy\" ~ \"Healthy\",\n            category == \"Fresh_icm\" ~ \"ICM\",\n            category == \"Fresh_nicm\" ~ \"NICM\",\n            category == \"Fresh_hcm\" ~ \"HCM\"\n        ),\n        category = factor(\n            category,\n            levels = c(\"Healthy\", \"ICM\", \"NICM\", \"HCM\")\n        )\n    ) |>\n    ggplot2::ggplot(\n        ggplot2::aes(\n            x = position,\n            y = score,\n            color = category\n        )\n    ) +\n    ggplot2::geom_line(size = 0.5) +\n    ggplot2::scale_x_continuous(\n        name = \"Distance from TSS (bp)\",\n        breaks = c(101, 1101, 2101, 3101, 4100),\n        labels = seq(-2000, 2000, 1000)\n    ) +\n    ggplot2::scale_y_continuous(\n        name = \"Normalized cut sites\"\n    ) +\n    ggplot2::scale_color_manual(\n        name = NULL,\n        values = as.character(yarrr::piratepal(palette = \"google\"))\n    ) +\n    ggplot2::ggtitle(label = \"TSS enrichment score\") +\n    ggplot2::theme_linedraw(base_size = 6, base_family = \"Arial\") +\n    ggplot2::theme(\n        legend.background = ggplot2::element_blank(),\n        legend.margin = ggplot2::margin(\n            t = 0, r = 0, b = 0, l = 0, unit = \"mm\"\n        ),\n        legend.spacing.y = grid::unit(0, \"mm\"),\n        legend.key = ggplot2::element_blank(),\n        legend.key.size = grid::unit(3, \"mm\"),\n        legend.text = ggplot2::element_text(\n            family = \"Arial\",\n            size = 5,\n            margin = ggplot2::margin(\n                t = 0, r = 0, b = 0, l = -1, unit = \"mm\"\n            )\n        ),\n        legend.position = c(0.7, 0.9),\n        legend.justification = c(0, 1),\n        plot.title = ggplot2::element_text(\n            family = \"Arial\", size = 6, hjust = 0.5\n        ),\n        plot.background = ggplot2::element_blank()\n    )\n\n\n\n\n\n\n\n\n\nList files.\n\nfs::dir_ls(\n    path = file.path(\n        PROJECT_DIR,\n        \"qc\",\n        \"tss_enrichment/raw/core_set_merged\",\n        \"cut_site\"\n    ),\n    regexp = \"npy$\"\n)\n\n/Users/jialei/Dropbox/Data/Projects/UTSW/Cardiomyopathy/atac-seq/qc/tss_enrichment/raw/core_set_merged/cut_site/Aligned_sorted_deduped_q10_fresh_hcm_21_tss_flanking_0.npy\n/Users/jialei/Dropbox/Data/Projects/UTSW/Cardiomyopathy/atac-seq/qc/tss_enrichment/raw/core_set_merged/cut_site/Aligned_sorted_deduped_q10_fresh_healthy_21_tss_flanking_0.npy\n/Users/jialei/Dropbox/Data/Projects/UTSW/Cardiomyopathy/atac-seq/qc/tss_enrichment/raw/core_set_merged/cut_site/Aligned_sorted_deduped_q10_fresh_icm_21_tss_flanking_0.npy\n/Users/jialei/Dropbox/Data/Projects/UTSW/Cardiomyopathy/atac-seq/qc/tss_enrichment/raw/core_set_merged/cut_site/Aligned_sorted_deduped_q10_fresh_nicm_21_tss_flanking_0.npy\n\n\nInspect data.\n\nfs::dir_ls(\n    path = file.path(\n        PROJECT_DIR,\n        \"qc\",\n        \"tss_enrichment/raw/core_set_merged\",\n        \"cut_site\"\n    ),\n    regexp = \"npy$\"\n) |>\n    purrr::map(\\(x) {\n        np$load(file = x) |>\n            {\n                \\(y) {\n                    y / mean(c(y[1:100], y[4102:4201]))\n                }\n            }() |>\n            tibble::enframe(name = \"position\", value = \"score\") |>\n            dplyr::mutate(\n                category = x |>\n                    basename() |>\n                    stringr::str_remove(\n                        pattern = \"Aligned_sorted_deduped_q10_\"\n                    ) |>\n                    stringr::str_remove(\n                        pattern = \"_21_tss_flanking_0.npy\"\n                    )\n            )\n    }) |>\n    dplyr::bind_rows() |>\n    dplyr::mutate(\n        category = category |> stringr::str_to_title(),\n        category = dplyr::case_when(\n            category == \"Fresh_healthy\" ~ \"Healthy\",\n            category == \"Fresh_icm\" ~ \"ICM\",\n            category == \"Fresh_nicm\" ~ \"NICM\",\n            category == \"Fresh_hcm\" ~ \"HCM\"\n        ),\n        category = factor(\n            category,\n            levels = c(\"Healthy\", \"ICM\", \"NICM\", \"HCM\")\n        )\n    ) |>\n    head(n = 12)\n\n# A tibble: 12 × 3\n   position     score category\n      <int> <dbl[1d]> <fct>   \n 1        1     0.648 HCM     \n 2        2     0.657 HCM     \n 3        3     0.664 HCM     \n 4        4     0.678 HCM     \n 5        5     0.681 HCM     \n 6        6     0.690 HCM     \n 7        7     0.699 HCM     \n 8        8     0.708 HCM     \n 9        9     0.719 HCM     \n10       10     0.729 HCM     \n11       11     0.744 HCM     \n12       12     0.748 HCM     \n\n\n\n\n\nMitochondrial percentage\n\n\n\n\nCodedataset |>\n    dplyr::mutate(mt_ratio = num_reads_q10_mt / num_reads_q10) |>\n    dplyr::mutate(\n        category = factor(\n            category,\n            levels = c(\"Healthy\", \"ICM\", \"NICM\", \"HCM\") |> rev()\n        )\n    ) |>\n    ggplot2::ggplot(\n        ggplot2::aes(\n            x = mt_ratio, y = category, fill = category\n        )\n    ) +\n    ggridges::geom_density_ridges(alpha = 0.8, color = NA) +\n    ggplot2::scale_x_continuous(\n        labels = scales::percent,\n    ) +\n    ggplot2::scale_fill_manual(\n        values = yarrr::piratepal(palette = \"google\") |>\n            as.character() |> rev(),\n    ) +\n    ggplot2::labs(x = \"Mitochondrial read percentage\", y = NULL) +\n    ggplot2::guides(fill = \"none\") +\n    ggplot2::ggtitle(label = \"Mitochondrial percentage\") +\n    ggplot2::theme_linedraw(base_size = 6, base_family = \"Arial\") +\n    ggplot2::theme(\n        legend.background = ggplot2::element_blank(),\n        plot.title = ggplot2::element_text(\n            family = \"Arial\", size = 6, hjust = 0.5\n        ),\n        plot.background = ggplot2::element_blank()\n    )\n\n\n\n\n\n\n\nFragment size distribution\n\n\n\n\n\nPlot\nData\n\n\n\n\nCodefs::dir_ls(\n    path = file.path(\n        PROJECT_DIR,\n        \"qc\",\n        \"fragment_sizes\",\n        \"raw\"\n    ),\n    regexp = \"fresh.+_CollectInsertSizeMetrics.txt\"\n) |>\n    purrr::map(\\(x) {\n        readr::read_delim(\n            file = x,\n            delim = \"\\t\",\n            skip = 11,\n            show_col_types = FALSE\n        ) |>\n            normalize_fragment_sizes(\n                category = x |>\n                    basename() |>\n                    stringr::str_remove(\n                        pattern = \"_CollectInsertSizeMetrics.txt\"\n                    ) |>\n                    stringr::str_to_title()\n            )\n    }) |>\n    dplyr::bind_rows() |>\n    dplyr::mutate(\n        category = dplyr::case_when(\n            category == \"Fresh_healthy\" ~ \"Healthy\",\n            category == \"Fresh_icm\" ~ \"ICM\",\n            category == \"Fresh_nicm\" ~ \"NICM\",\n            category == \"Fresh_hcm\" ~ \"HCM\"\n        ),\n        category = factor(\n            category,\n            levels = c(\n                \"Healthy\", \"ICM\", \"NICM\", \"HCM\"\n            )\n        )\n    ) |>\n    ggplot2::ggplot(\n        ggplot2::aes(\n            x = insert_size,\n            y = norm_count,\n            color = category\n        )\n    ) +\n    ggplot2::geom_line() +\n    ggplot2::scale_x_continuous(\n        name = \"Fragment size (bp)\",\n        limits = c(0, 1000),\n        breaks = seq(0, 1000, 200)\n    ) +\n    ggplot2::scale_y_continuous(\n        name = \"Norm. read density\",\n        labels = scales::math_format(10^.x)\n    ) +\n    ggplot2::annotation_logticks(base = 10, sides = \"l\", scaled = TRUE) +\n    ggplot2::scale_color_manual(\n        name = NULL,\n        values = as.character(yarrr::piratepal(palette = \"google\"))\n    ) +\n    ggplot2::ggtitle(label = \"Fragment size distribution\") +\n    ggplot2::theme_bw(base_size = 6, base_family = \"Arial\") +\n    ggplot2::theme(\n        legend.background = ggplot2::element_blank(),\n        legend.margin = ggplot2::margin(\n            t = 0, r = 0, b = 0, l = 0, unit = \"mm\"\n        ),\n        legend.spacing.y = ggplot2::unit(0, \"mm\"),\n        legend.key = ggplot2::element_blank(),\n        legend.key.size = ggplot2::unit(3, \"mm\"),\n        legend.text = ggplot2::element_text(\n            family = \"Arial\",\n            size = 5,\n            margin = ggplot2::margin(\n                t = 0, r = 0, b = 0, l = -1, unit = \"mm\"\n            )\n        ),\n        legend.position = c(0.7, 0.9),\n        legend.justification = c(0, 1),\n        legend.box.background = ggplot2::element_blank(),\n        panel.background = ggplot2::element_blank(),\n        plot.title = ggplot2::element_text(\n            family = \"Arial\", size = 6, hjust = 0.5\n        ),\n        plot.background = ggplot2::element_blank()\n    )\n\n\n\n\n\n\n\n\n\nList files.\n\nfs::dir_ls(\n    path = file.path(\n        PROJECT_DIR,\n        \"qc\",\n        \"fragment_sizes\",\n        \"raw\"\n    ),\n    regexp = \"fresh.+_CollectInsertSizeMetrics.txt\"\n)\n\n/Users/jialei/Dropbox/Data/Projects/UTSW/Cardiomyopathy/atac-seq/qc/fragment_sizes/raw/fresh_hcm_CollectInsertSizeMetrics.txt\n/Users/jialei/Dropbox/Data/Projects/UTSW/Cardiomyopathy/atac-seq/qc/fragment_sizes/raw/fresh_healthy_CollectInsertSizeMetrics.txt\n/Users/jialei/Dropbox/Data/Projects/UTSW/Cardiomyopathy/atac-seq/qc/fragment_sizes/raw/fresh_icm_CollectInsertSizeMetrics.txt\n/Users/jialei/Dropbox/Data/Projects/UTSW/Cardiomyopathy/atac-seq/qc/fragment_sizes/raw/fresh_nicm_CollectInsertSizeMetrics.txt\n\n\nInspect data.\n\nfs::dir_ls(\n    path = file.path(\n        PROJECT_DIR,\n        \"qc\",\n        \"fragment_sizes\",\n        \"raw\"\n    ),\n    regexp = \"fresh.+_CollectInsertSizeMetrics.txt\"\n) |>\n    purrr::map(\\(x) {\n        readr::read_delim(\n            file = x,\n            delim = \"\\t\",\n            skip = 11,\n            show_col_types = FALSE\n        ) |>\n            normalize_fragment_sizes(\n                category = x |>\n                    basename() |>\n                    stringr::str_remove(\n                        pattern = \"_CollectInsertSizeMetrics.txt\"\n                    ) |>\n                    stringr::str_to_title()\n            )\n    }) |>\n    dplyr::bind_rows() |>\n    dplyr::mutate(\n        category = dplyr::case_when(\n            category == \"Fresh_healthy\" ~ \"Healthy\",\n            category == \"Fresh_icm\" ~ \"ICM\",\n            category == \"Fresh_nicm\" ~ \"NICM\",\n            category == \"Fresh_hcm\" ~ \"HCM\"\n        ),\n        category = factor(\n            category,\n            levels = c(\n                \"Healthy\", \"ICM\", \"NICM\", \"HCM\"\n            )\n        )\n    ) |>\n    head(n = 12)\n\n# A tibble: 12 × 6\n   insert_size All_Reads.fr_count All_Reads.rf_count all_reads…¹ norm_…² categ…³\n         <dbl>              <dbl>              <dbl>       <dbl>   <dbl> <fct>  \n 1          20                 59                 62          59   -6.53 HCM    \n 2          21                 81                100          81   -6.40 HCM    \n 3          22                135                115         135   -6.17 HCM    \n 4          23                169                174         169   -6.08 HCM    \n 5          24                362                374         362   -5.75 HCM    \n 6          25               1357               1427        1357   -5.17 HCM    \n 7          26              23899              23859       23899   -3.93 HCM    \n 8          27              49856              49877       49856   -3.61 HCM    \n 9          28              46698              46688       46698   -3.64 HCM    \n10          29              46807              46847       46807   -3.63 HCM    \n11          30              42295              42213       42295   -3.68 HCM    \n12          31              36400              36158       36400   -3.74 HCM    \n# … with abbreviated variable names ¹​all_reads_count, ²​norm_count, ³​category\n\n\n\n\n\nChromatin states\n\nfragment_size <- fs::dir_ls(\n    path = file.path(\n        PROJECT_DIR,\n        \"qc\",\n        \"fragment_sizes\",\n        \"raw\"\n    ),\n    regexp = \"fresh.+_CollectInsertSizeMetrics.txt\"\n) |>\n    purrr::map(\\(x) {\n        a <- readr::read_delim(\n            file = x,\n            delim = \"\\t\",\n            skip = 11,\n            show_col_types = FALSE\n        )\n        a <- setNames(\n            object = a$All_Reads.fr_count,\n            nm = a$insert_size\n        )\n        a\n    })\n\nnames(fragment_size) <- names(fragment_size) |>\n    basename() |>\n    stringr::str_remove(\n        pattern = \"_CollectInsertSizeMetrics.txt\"\n    )\n\n\nPlot\n\n\n\nCodez <- c(\"Healthy\", \"ICM\", \"NICM\", \"HCM\")\n\npurrr::map2(\n    c(\"fresh_healthy\", \"fresh_icm\", \"fresh_nicm\", \"fresh_hcm\"), z, \\(x, z) {\n        sample_name <- x\n        fragment_size_distribution <- fs::dir_ls(\n            path = file.path(\n                PROJECT_DIR,\n                \"qc/chromatin_states\",\n                \"raw\",\n                sample_name\n            ),\n            regexp = \"\\\\.txt\"\n        ) |>\n            purrr::map(\\(y) {\n                sample_name <- stringr::str_remove(\n                    string = basename(y),\n                    pattern = \".+\\\\.bam_fragments_\"\n                ) |>\n                    str_remove(\n                        pattern = \".txt\"\n                    )\n\n                readr::read_delim(\n                    file = file.path(\n                        y\n                    ),\n                    delim = \"\\t\",\n                    col_names = c(\"fragment_size\", \"count\")\n                ) |>\n                    dplyr::filter(\n                        fragment_size >= 50,\n                        fragment_size <= 750\n                    ) |>\n                    dplyr::mutate(\n                        category = sample_name\n                    ) |>\n                    dplyr::select(\n                        fragment_size,\n                        count,\n                        category\n                    )\n            })\n\n        fragment_size_distribution <- fragment_size_distribution |>\n            purrr::map(\\(x) {\n                x[[\"percentage\"]] <- (\n                    x[[\"count\"]] / (\n                        fragment_size[[sample_name]]\n                    )[x$fragment_size]\n                )\n                x[[\"value\"]] <- as.vector(scale(x[[\"percentage\"]]))\n\n                x_limits <- quantile(x[[\"value\"]], c(0.1, 0.9))\n                x[[\"value\"]][x[[\"value\"]] <= x_limits[1]] <- x_limits[[1]]\n                x[[\"value\"]][x[[\"value\"]] >= x_limits[2]] <- x_limits[[2]]\n                x\n            })\n\n        fragment_size_distribution |>\n            dplyr::bind_rows() |>\n            dplyr::mutate(\n                category = factor(\n                    category,\n                    levels = c(\n                        \"CTCF_binding_site\",\n                        \"promoter\",\n                        \"promoter_flanking_region\",\n                        \"enhancer\",\n                        \"TF_binding_site\",\n                        \"open_chromatin_region\"\n                    ) |> rev()\n                )\n            ) |>\n            ggplot2::ggplot(\n                ggplot2::aes(\n                    x = fragment_size,\n                    y = category,\n                    fill = value\n                )\n            ) +\n            ggplot2::geom_tile(ggplot2::aes(fill = value)) +\n            ggplot2::scale_fill_gradient2(name = NULL) +\n            ggplot2::scale_x_continuous(\n                name = \"Fragment size (bp)\",\n                limits = c(50, 750),\n                breaks = seq(50, 750, 175)\n            ) +\n            ggplot2::scale_y_discrete(name = NULL) +\n            ggplot2::ggtitle(label = z) +\n            ggplot2::theme_linedraw(base_size = 6, base_family = \"Arial\") +\n            ggplot2::theme(\n                legend.background = ggplot2::element_blank(),\n                legend.margin = ggplot2::margin(\n                    t = 0, r = 0, b = 0, l = 0, unit = \"mm\"\n                ),\n                legend.key = ggplot2::element_blank(),\n                legend.key.height = ggplot2::unit(2, \"mm\"),\n                legend.key.width = ggplot2::unit(2, \"mm\"),\n                legend.text = ggplot2::element_text(\n                    family = \"Arial\",\n                    # size = 6,\n                    margin = ggplot2::margin(\n                        t = 0, r = 0, b = 0, l = -0.5, unit = \"mm\"\n                    )\n                ),\n                legend.box.margin = ggplot2::margin(\n                    t = 0, r = 0, b = 0, l = -1, unit = \"mm\"\n                ),\n                legend.box.background = ggplot2::element_blank(),\n                #\n\n                plot.title = ggplot2::element_text(\n                    family = \"Arial\", size = 6, hjust = 0.5\n                )\n            )\n    }\n) |>\n    purrr::reduce(`+`) +\n    patchwork::plot_layout(ncol = 1) +\n    patchwork::plot_annotation(\n        theme = ggplot2::theme(plot.margin = ggplot2::margin())\n    )"
  },
  {
    "objectID": "qc.html#r-session-info",
    "href": "qc.html#r-session-info",
    "title": "Quality Control",
    "section": "R session info",
    "text": "R session info\n\ndevtools::session_info()\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.2.1 (2022-06-23)\n os       macOS Monterey 12.6\n system   aarch64, darwin21.6.0\n ui       unknown\n language (EN)\n collate  en_US.UTF-8\n ctype    en_US.UTF-8\n tz       America/Chicago\n date     2022-09-22\n pandoc   2.19.2 @ /opt/homebrew/bin/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package       * version       date (UTC) lib source\n BayesFactor     0.9.12-4.4    2022-07-05 [1] CRAN (R 4.2.1)\n bit             4.0.4         2020-08-04 [1] CRAN (R 4.2.0)\n bit64           4.0.5         2020-08-30 [1] CRAN (R 4.2.0)\n cachem          1.0.6         2021-08-19 [1] CRAN (R 4.2.0)\n callr           3.7.2         2022-08-22 [1] CRAN (R 4.2.1)\n circlize        0.4.15        2022-05-10 [1] CRAN (R 4.2.0)\n cli             3.4.0         2022-09-08 [1] CRAN (R 4.2.1)\n coda            0.19-4        2020-09-30 [1] CRAN (R 4.2.0)\n colorspace      2.0-3         2022-02-21 [1] CRAN (R 4.2.0)\n crayon          1.5.1         2022-03-26 [1] CRAN (R 4.2.0)\n devtools        2.4.4.9000    2022-08-11 [1] Github (r-lib/devtools@c9696a6)\n digest          0.6.29        2021-12-01 [1] CRAN (R 4.2.0)\n dplyr         * 1.0.99.9000   2022-09-21 [1] Github (tidyverse/dplyr@60f7a2d)\n ellipsis        0.3.2         2021-04-29 [1] CRAN (R 4.2.0)\n evaluate        0.16          2022-08-09 [1] CRAN (R 4.2.1)\n extrafont     * 0.18          2022-04-12 [1] CRAN (R 4.2.0)\n extrafontdb     1.0           2012-06-11 [1] CRAN (R 4.2.0)\n fansi           1.0.3         2022-03-24 [1] CRAN (R 4.2.0)\n farver          2.1.1         2022-07-06 [1] CRAN (R 4.2.1)\n fastmap         1.1.0         2021-01-25 [1] CRAN (R 4.2.0)\n forcats       * 0.5.2.9000    2022-08-20 [1] Github (tidyverse/forcats@bd319e0)\n fs              1.5.2.9000    2022-08-24 [1] Github (r-lib/fs@238032f)\n generics        0.1.3         2022-07-05 [1] CRAN (R 4.2.1)\n ggplot2       * 3.3.6.9000    2022-09-12 [1] Github (tidyverse/ggplot2@a58b48c)\n ggridges        0.5.3         2021-01-08 [1] CRAN (R 4.2.0)\n GlobalOptions   0.1.2         2020-06-10 [1] CRAN (R 4.2.0)\n glue            1.6.2.9000    2022-04-22 [1] Github (tidyverse/glue@d47d6c7)\n gtable          0.3.1.9000    2022-09-01 [1] Github (r-lib/gtable@c1a7a81)\n hms             1.1.2         2022-08-19 [1] CRAN (R 4.2.1)\n htmltools       0.5.3         2022-07-18 [1] CRAN (R 4.2.1)\n htmlwidgets     1.5.4         2022-08-23 [1] Github (ramnathv/htmlwidgets@400cf1a)\n httpuv          1.6.6         2022-09-08 [1] CRAN (R 4.2.1)\n jpeg            0.1-9         2021-07-24 [1] CRAN (R 4.2.0)\n jsonlite        1.8.0         2022-02-22 [1] CRAN (R 4.2.0)\n knitr           1.40          2022-08-24 [1] CRAN (R 4.2.1)\n labeling        0.4.2         2020-10-20 [1] CRAN (R 4.2.0)\n later           1.3.0         2021-08-18 [1] CRAN (R 4.2.0)\n lattice         0.20-45       2021-09-22 [2] CRAN (R 4.2.1)\n lifecycle       1.0.2.9000    2022-09-09 [1] Github (r-lib/lifecycle@a2666fc)\n lubridate     * 1.8.0.9000    2022-05-24 [1] Github (tidyverse/lubridate@0bb49b2)\n magrittr        2.0.3         2022-03-30 [1] CRAN (R 4.2.0)\n Matrix        * 1.5-1         2022-09-13 [1] CRAN (R 4.2.1)\n MatrixModels    0.5-1         2022-09-11 [1] CRAN (R 4.2.1)\n memoise         2.0.1         2021-11-26 [1] CRAN (R 4.2.0)\n mime            0.12          2021-09-28 [1] CRAN (R 4.2.0)\n miniUI          0.1.1.1       2018-05-18 [1] CRAN (R 4.2.0)\n munsell         0.5.0         2018-06-12 [1] CRAN (R 4.2.0)\n mvtnorm         1.1-3         2021-10-08 [1] CRAN (R 4.2.1)\n patchwork     * 1.1.2.9000    2022-08-20 [1] Github (thomasp85/patchwork@c14c960)\n pbapply         1.5-0         2021-09-16 [1] CRAN (R 4.2.0)\n pillar          1.8.1         2022-08-19 [1] CRAN (R 4.2.1)\n pkgbuild        1.3.1         2021-12-20 [1] CRAN (R 4.2.0)\n pkgconfig       2.0.3         2019-09-22 [1] CRAN (R 4.2.0)\n pkgload         1.3.0         2022-06-27 [1] CRAN (R 4.2.1)\n plyr            1.8.7         2022-03-24 [1] CRAN (R 4.2.0)\n png             0.1-7         2013-12-03 [1] CRAN (R 4.2.0)\n prettyunits     1.1.1.9000    2022-04-22 [1] Github (r-lib/prettyunits@8706d89)\n processx        3.7.0         2022-07-07 [1] CRAN (R 4.2.1)\n profvis         0.3.7         2020-11-02 [1] CRAN (R 4.2.0)\n promises        1.2.0.1       2021-02-11 [1] CRAN (R 4.2.0)\n ps              1.7.1         2022-06-18 [1] CRAN (R 4.2.0)\n purrr         * 0.9000.0.9000 2022-09-21 [1] Github (tidyverse/purrr@194b8ef)\n R.cache         0.16.0        2022-07-21 [1] CRAN (R 4.2.1)\n R.methodsS3     1.8.2         2022-06-13 [1] CRAN (R 4.2.0)\n R.oo            1.25.0        2022-06-12 [1] CRAN (R 4.2.0)\n R.utils         2.12.0        2022-06-28 [1] CRAN (R 4.2.1)\n R6              2.5.1.9000    2022-08-04 [1] Github (r-lib/R6@87d5e45)\n ragg            1.2.2.9000    2022-09-12 [1] Github (r-lib/ragg@904e145)\n Rcpp            1.0.9         2022-07-08 [1] CRAN (R 4.2.1)\n readr         * 2.1.2.9000    2022-09-20 [1] Github (tidyverse/readr@5cac6ed)\n remotes         2.4.2         2022-09-12 [1] Github (r-lib/remotes@bc0949d)\n reticulate      1.26          2022-08-31 [1] CRAN (R 4.2.1)\n rlang           1.0.5.9000    2022-09-16 [1] Github (r-lib/rlang@5a25ff4)\n rmarkdown       2.16.1        2022-08-25 [1] Github (rstudio/rmarkdown@b8a9879)\n Rttf2pt1        1.3.10        2022-02-07 [1] CRAN (R 4.2.0)\n scales          1.2.1.9000    2022-08-20 [1] Github (r-lib/scales@b3df2fb)\n sessioninfo     1.2.2         2021-12-06 [1] CRAN (R 4.2.0)\n shape           1.4.6         2021-05-19 [1] CRAN (R 4.2.0)\n shiny           1.7.2         2022-07-19 [1] CRAN (R 4.2.1)\n stringi         1.7.8         2022-07-11 [1] CRAN (R 4.2.1)\n stringr       * 1.4.1.9000    2022-08-21 [1] Github (tidyverse/stringr@792bc92)\n styler        * 1.7.0.9002    2022-09-21 [1] Github (r-lib/styler@1f4437b)\n systemfonts     1.0.4         2022-02-11 [1] CRAN (R 4.2.0)\n textshaping     0.3.6         2021-10-13 [1] CRAN (R 4.2.0)\n tibble        * 3.1.8.9001    2022-09-20 [1] Github (tidyverse/tibble@b740af1)\n tidyr         * 1.2.1.9000    2022-09-09 [1] Github (tidyverse/tidyr@653def2)\n tidyselect      1.1.2.9000    2022-09-21 [1] Github (r-lib/tidyselect@edd0a3b)\n tidyverse     * 1.3.2.9000    2022-09-12 [1] Github (tidyverse/tidyverse@3be8283)\n tzdb            0.3.0         2022-03-28 [1] CRAN (R 4.2.0)\n urlchecker      1.0.1         2021-11-30 [1] CRAN (R 4.2.0)\n usethis         2.1.6.9000    2022-09-15 [1] Github (r-lib/usethis@7c34252)\n utf8            1.2.2         2021-07-24 [1] CRAN (R 4.2.0)\n vctrs           0.4.1.9000    2022-09-19 [1] Github (r-lib/vctrs@0a219ba)\n vroom           1.5.7.9000    2022-09-09 [1] Github (r-lib/vroom@0c2423e)\n withr           2.5.0         2022-03-03 [1] CRAN (R 4.2.0)\n xfun            0.33          2022-09-12 [1] CRAN (R 4.2.1)\n xtable          1.8-4         2019-04-21 [1] CRAN (R 4.2.0)\n yaml            2.3.5         2022-02-21 [1] CRAN (R 4.2.0)\n yarrr           0.1.6         2022-04-22 [1] Github (ndphillips/yarrr@e2e4488)\n\n [1] /opt/homebrew/lib/R/4.2/site-library\n [2] /opt/homebrew/Cellar/r/4.2.1_4/lib/R/library\n\n─ Python configuration ───────────────────────────────────────────────────────\n python:         /Users/jialei/.pyenv/shims/python\n libpython:      /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/libpython3.9.dylib\n pythonhome:     /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10:/Users/jialei/.pyenv/versions/mambaforge-4.10.3-10\n version:        3.9.13 | packaged by conda-forge | (main, May 27 2022, 17:00:33)  [Clang 13.0.1 ]\n numpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy\n numpy_version:  1.22.4\n numpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy\n \n NOTE: Python version was forced by RETICULATE_PYTHON\n\n──────────────────────────────────────────────────────────────────────────────"
  },
  {
    "objectID": "cardiomyopathy.html#r-session-info",
    "href": "cardiomyopathy.html#r-session-info",
    "title": "Accurate Classification of Cardiomyopathy Diagnosis by Chromatin Accessibility",
    "section": "R session info",
    "text": "R session info\n\ndevtools::session_info()\n\n─ Session info ───────────────────────────────────────────────────────────────\n setting  value\n version  R version 4.2.1 (2022-06-23)\n os       macOS Monterey 12.6\n system   aarch64, darwin21.6.0\n ui       unknown\n language (EN)\n collate  en_US.UTF-8\n ctype    en_US.UTF-8\n tz       America/Chicago\n date     2022-09-22\n pandoc   2.19.2 @ /opt/homebrew/bin/ (via rmarkdown)\n\n─ Packages ───────────────────────────────────────────────────────────────────\n package              * version       date (UTC) lib source\n annotate               1.74.0        2022-04-26 [1] Bioconductor\n AnnotationDbi          1.58.0        2022-04-26 [1] Bioconductor\n BayesFactor            0.9.12-4.4    2022-07-05 [1] CRAN (R 4.2.1)\n beeswarm               0.4.0         2021-06-01 [1] CRAN (R 4.2.0)\n Biobase              * 2.56.0        2022-04-26 [1] Bioconductor\n BiocGenerics         * 0.42.0        2022-04-26 [1] Bioconductor\n BiocParallel           1.30.3        2022-06-05 [1] Bioconductor\n Biostrings             2.64.1        2022-08-18 [1] Bioconductor\n bit                    4.0.4         2020-08-04 [1] CRAN (R 4.2.0)\n bit64                  4.0.5         2020-08-30 [1] CRAN (R 4.2.0)\n bitops                 1.0-7         2021-04-24 [1] CRAN (R 4.2.0)\n blob                   1.2.3         2022-04-10 [1] CRAN (R 4.2.0)\n cachem                 1.0.6         2021-08-19 [1] CRAN (R 4.2.0)\n Cairo                  1.6-0         2022-07-05 [1] CRAN (R 4.2.1)\n callr                  3.7.2         2022-08-22 [1] CRAN (R 4.2.1)\n circlize               0.4.15        2022-05-10 [1] CRAN (R 4.2.0)\n cli                    3.4.0         2022-09-08 [1] CRAN (R 4.2.1)\n clue                   0.3-61        2022-05-30 [1] CRAN (R 4.2.0)\n cluster                2.1.4         2022-08-22 [2] CRAN (R 4.2.1)\n coda                   0.19-4        2020-09-30 [1] CRAN (R 4.2.0)\n codetools              0.2-18        2020-11-04 [2] CRAN (R 4.2.1)\n colorspace             2.0-3         2022-02-21 [1] CRAN (R 4.2.0)\n ComplexHeatmap         2.12.1        2022-08-09 [1] Bioconductor\n crayon                 1.5.1         2022-03-26 [1] CRAN (R 4.2.0)\n DBI                    1.1.3         2022-06-18 [1] CRAN (R 4.2.0)\n DelayedArray           0.22.0        2022-04-26 [1] Bioconductor\n DESeq2               * 1.36.0        2022-04-26 [1] Bioconductor\n devtools               2.4.4.9000    2022-08-11 [1] Github (r-lib/devtools@c9696a6)\n digest                 0.6.29        2021-12-01 [1] CRAN (R 4.2.0)\n doParallel             1.0.17        2022-02-07 [1] CRAN (R 4.2.0)\n dplyr                * 1.0.99.9000   2022-09-21 [1] Github (tidyverse/dplyr@60f7a2d)\n ellipsis               0.3.2         2021-04-29 [1] CRAN (R 4.2.0)\n evaluate               0.16          2022-08-09 [1] CRAN (R 4.2.1)\n extrafont            * 0.18          2022-04-12 [1] CRAN (R 4.2.0)\n extrafontdb            1.0           2012-06-11 [1] CRAN (R 4.2.0)\n fansi                  1.0.3         2022-03-24 [1] CRAN (R 4.2.0)\n farver                 2.1.1         2022-07-06 [1] CRAN (R 4.2.1)\n fastmap                1.1.0         2021-01-25 [1] CRAN (R 4.2.0)\n FNN                    1.1.3.1       2022-05-23 [1] CRAN (R 4.2.0)\n forcats              * 0.5.2.9000    2022-08-20 [1] Github (tidyverse/forcats@bd319e0)\n foreach                1.5.2         2022-02-02 [1] CRAN (R 4.2.0)\n fs                     1.5.2.9000    2022-08-24 [1] Github (r-lib/fs@238032f)\n genefilter             1.78.0        2022-04-26 [1] Bioconductor\n geneplotter            1.74.0        2022-04-26 [1] Bioconductor\n generics               0.1.3         2022-07-05 [1] CRAN (R 4.2.1)\n GenomeInfoDb         * 1.32.4        2022-09-06 [1] Bioconductor\n GenomeInfoDbData       1.2.8         2022-04-22 [1] Bioconductor\n GenomicRanges        * 1.48.0        2022-04-26 [1] Bioconductor\n GetoptLong             1.0.5         2020-12-15 [1] CRAN (R 4.2.0)\n ggbeeswarm             0.6.0         2017-08-07 [1] CRAN (R 4.2.0)\n ggplot2              * 3.3.6.9000    2022-09-12 [1] Github (tidyverse/ggplot2@a58b48c)\n ggrastr                1.0.1         2022-09-12 [1] Github (VPetukhov/ggrastr@7aed9af)\n GlobalOptions          0.1.2         2020-06-10 [1] CRAN (R 4.2.0)\n glue                   1.6.2.9000    2022-04-22 [1] Github (tidyverse/glue@d47d6c7)\n gtable                 0.3.1.9000    2022-09-01 [1] Github (r-lib/gtable@c1a7a81)\n highr                  0.9           2021-04-16 [1] CRAN (R 4.2.0)\n hms                    1.1.2         2022-08-19 [1] CRAN (R 4.2.1)\n htmltools              0.5.3         2022-07-18 [1] CRAN (R 4.2.1)\n htmlwidgets            1.5.4         2022-08-23 [1] Github (ramnathv/htmlwidgets@400cf1a)\n httpuv                 1.6.6         2022-09-08 [1] CRAN (R 4.2.1)\n httr                   1.4.4         2022-08-17 [1] CRAN (R 4.2.1)\n IRanges              * 2.30.1        2022-08-18 [1] Bioconductor\n irlba                  2.3.5         2021-12-06 [1] CRAN (R 4.2.1)\n isoband                0.2.5         2021-07-13 [1] CRAN (R 4.2.0)\n iterators              1.0.14        2022-02-05 [1] CRAN (R 4.2.0)\n jpeg                   0.1-9         2021-07-24 [1] CRAN (R 4.2.0)\n jsonlite               1.8.0         2022-02-22 [1] CRAN (R 4.2.0)\n KEGGREST               1.36.3        2022-07-12 [1] Bioconductor\n knitr                  1.40          2022-08-24 [1] CRAN (R 4.2.1)\n labeling               0.4.2         2020-10-20 [1] CRAN (R 4.2.0)\n later                  1.3.0         2021-08-18 [1] CRAN (R 4.2.0)\n lattice                0.20-45       2021-09-22 [2] CRAN (R 4.2.1)\n lifecycle              1.0.2.9000    2022-09-09 [1] Github (r-lib/lifecycle@a2666fc)\n locfit                 1.5-9.6       2022-07-11 [1] CRAN (R 4.2.1)\n lubridate            * 1.8.0.9000    2022-05-24 [1] Github (tidyverse/lubridate@0bb49b2)\n magick                 2.7.3         2021-08-18 [1] CRAN (R 4.2.0)\n magrittr               2.0.3         2022-03-30 [1] CRAN (R 4.2.0)\n MASS                   7.3-58.1      2022-08-03 [2] CRAN (R 4.2.1)\n Matrix               * 1.5-1         2022-09-13 [1] CRAN (R 4.2.1)\n MatrixGenerics       * 1.8.1         2022-06-26 [1] Bioconductor\n MatrixModels           0.5-1         2022-09-11 [1] CRAN (R 4.2.1)\n matrixStats          * 0.62.0        2022-04-19 [1] CRAN (R 4.2.0)\n memoise                2.0.1         2021-11-26 [1] CRAN (R 4.2.0)\n mime                   0.12          2021-09-28 [1] CRAN (R 4.2.0)\n miniUI                 0.1.1.1       2018-05-18 [1] CRAN (R 4.2.0)\n munsell                0.5.0         2018-06-12 [1] CRAN (R 4.2.0)\n mvtnorm                1.1-3         2021-10-08 [1] CRAN (R 4.2.1)\n patchwork            * 1.1.2.9000    2022-08-20 [1] Github (thomasp85/patchwork@c14c960)\n pbapply                1.5-0         2021-09-16 [1] CRAN (R 4.2.0)\n pillar                 1.8.1         2022-08-19 [1] CRAN (R 4.2.1)\n pkgbuild               1.3.1         2021-12-20 [1] CRAN (R 4.2.0)\n pkgconfig              2.0.3         2019-09-22 [1] CRAN (R 4.2.0)\n pkgload                1.3.0         2022-06-27 [1] CRAN (R 4.2.1)\n plyr                   1.8.7         2022-03-24 [1] CRAN (R 4.2.0)\n png                    0.1-7         2013-12-03 [1] CRAN (R 4.2.0)\n prettyunits            1.1.1.9000    2022-04-22 [1] Github (r-lib/prettyunits@8706d89)\n pROC                   1.18.0        2021-09-03 [1] CRAN (R 4.2.0)\n processx               3.7.0         2022-07-07 [1] CRAN (R 4.2.1)\n profvis                0.3.7         2020-11-02 [1] CRAN (R 4.2.0)\n promises               1.2.0.1       2021-02-11 [1] CRAN (R 4.2.0)\n ps                     1.7.1         2022-06-18 [1] CRAN (R 4.2.0)\n purrr                * 0.9000.0.9000 2022-09-21 [1] Github (tidyverse/purrr@194b8ef)\n R.cache                0.16.0        2022-07-21 [1] CRAN (R 4.2.1)\n R.methodsS3            1.8.2         2022-06-13 [1] CRAN (R 4.2.0)\n R.oo                   1.25.0        2022-06-12 [1] CRAN (R 4.2.0)\n R.utils                2.12.0        2022-06-28 [1] CRAN (R 4.2.1)\n R6                     2.5.1.9000    2022-08-04 [1] Github (r-lib/R6@87d5e45)\n ragg                   1.2.2.9000    2022-09-12 [1] Github (r-lib/ragg@904e145)\n randomForest           4.7-1.1       2022-05-23 [1] CRAN (R 4.2.1)\n RColorBrewer           1.1-3         2022-04-03 [1] CRAN (R 4.2.0)\n Rcpp                   1.0.9         2022-07-08 [1] CRAN (R 4.2.1)\n RCurl                  1.98-1.8      2022-07-30 [1] CRAN (R 4.2.1)\n readr                * 2.1.2.9000    2022-09-20 [1] Github (tidyverse/readr@5cac6ed)\n remotes                2.4.2         2022-09-12 [1] Github (r-lib/remotes@bc0949d)\n reticulate             1.26          2022-08-31 [1] CRAN (R 4.2.1)\n rjson                  0.2.21        2022-01-09 [1] CRAN (R 4.2.0)\n rlang                  1.0.5.9000    2022-09-16 [1] Github (r-lib/rlang@5a25ff4)\n rmarkdown              2.16.1        2022-08-25 [1] Github (rstudio/rmarkdown@b8a9879)\n RSQLite                2.2.17        2022-09-10 [1] CRAN (R 4.2.1)\n Rttf2pt1               1.3.10        2022-02-07 [1] CRAN (R 4.2.0)\n S4Vectors            * 0.34.0        2022-04-26 [1] Bioconductor\n scales                 1.2.1.9000    2022-08-20 [1] Github (r-lib/scales@b3df2fb)\n sessioninfo            1.2.2         2021-12-06 [1] CRAN (R 4.2.0)\n shape                  1.4.6         2021-05-19 [1] CRAN (R 4.2.0)\n shiny                  1.7.2         2022-07-19 [1] CRAN (R 4.2.1)\n stringi                1.7.8         2022-07-11 [1] CRAN (R 4.2.1)\n stringr              * 1.4.1.9000    2022-08-21 [1] Github (tidyverse/stringr@792bc92)\n styler               * 1.7.0.9002    2022-09-21 [1] Github (r-lib/styler@1f4437b)\n SummarizedExperiment * 1.26.1        2022-04-29 [1] Bioconductor\n survival               3.4-0         2022-08-09 [2] CRAN (R 4.2.1)\n systemfonts            1.0.4         2022-02-11 [1] CRAN (R 4.2.0)\n textshaping            0.3.6         2021-10-13 [1] CRAN (R 4.2.0)\n tibble               * 3.1.8.9001    2022-09-20 [1] Github (tidyverse/tibble@b740af1)\n tidyr                * 1.2.1.9000    2022-09-09 [1] Github (tidyverse/tidyr@653def2)\n tidyselect             1.1.2.9000    2022-09-21 [1] Github (r-lib/tidyselect@edd0a3b)\n tidyverse            * 1.3.2.9000    2022-09-12 [1] Github (tidyverse/tidyverse@3be8283)\n tzdb                   0.3.0         2022-03-28 [1] CRAN (R 4.2.0)\n urlchecker             1.0.1         2021-11-30 [1] CRAN (R 4.2.0)\n usethis                2.1.6.9000    2022-09-15 [1] Github (r-lib/usethis@7c34252)\n utf8                   1.2.2         2021-07-24 [1] CRAN (R 4.2.0)\n uwot                   0.1.14        2022-09-12 [1] Github (jlmelville/uwot@e739069)\n vctrs                  0.4.1.9000    2022-09-19 [1] Github (r-lib/vctrs@0a219ba)\n vipor                  0.4.5         2017-03-22 [1] CRAN (R 4.2.0)\n wesanderson            0.3.6.9000    2022-04-22 [1] Github (karthik/wesanderson@2796b59)\n withr                  2.5.0         2022-03-03 [1] CRAN (R 4.2.0)\n xfun                   0.33          2022-09-12 [1] CRAN (R 4.2.1)\n XML                    3.99-0.10     2022-06-09 [1] CRAN (R 4.2.0)\n xtable                 1.8-4         2019-04-21 [1] CRAN (R 4.2.0)\n XVector                0.36.0        2022-04-26 [1] Bioconductor\n yaml                   2.3.5         2022-02-21 [1] CRAN (R 4.2.0)\n yarrr                  0.1.6         2022-04-22 [1] Github (ndphillips/yarrr@e2e4488)\n zlibbioc               1.42.0        2022-04-26 [1] Bioconductor\n\n [1] /opt/homebrew/lib/R/4.2/site-library\n [2] /opt/homebrew/Cellar/r/4.2.1_4/lib/R/library\n\n─ Python configuration ───────────────────────────────────────────────────────\n python:         /Users/jialei/.pyenv/shims/python\n libpython:      /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/libpython3.9.dylib\n pythonhome:     /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10:/Users/jialei/.pyenv/versions/mambaforge-4.10.3-10\n version:        3.9.13 | packaged by conda-forge | (main, May 27 2022, 17:00:33)  [Clang 13.0.1 ]\n numpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy\n numpy_version:  1.22.4\n numpy:          /Users/jialei/.pyenv/versions/mambaforge-4.10.3-10/lib/python3.9/site-packages/numpy\n \n NOTE: Python version was forced by RETICULATE_PYTHON\n\n──────────────────────────────────────────────────────────────────────────────"
  }
]